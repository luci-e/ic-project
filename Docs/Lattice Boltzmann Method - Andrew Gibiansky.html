<!DOCTYPE html>
<!-- saved from url=(0066)http://andrew.gibiansky.com/blog/physics/lattice-boltzmann-method/ -->
<html class="no-js" lang="en" data-xlabs-extension="1" data-xlabs-extension-ready="1" data-xlabs-extension-version="2.6.1"><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <title>Lattice Boltzmann Method -  Andrew Gibiansky</title>
  <meta name="author" content="Andrew Gibiansky">

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="./Lattice Boltzmann Method - Andrew Gibiansky_files/css" rel="stylesheet" type="text/css">
  <link href="http://andrew.gibiansky.com/favicon.ico" rel="icon">
  <link rel="stylesheet" href="./Lattice Boltzmann Method - Andrew Gibiansky_files/font-awesome.min.css">
  <link href="./Lattice Boltzmann Method - Andrew Gibiansky_files/asciidoctor-default.css" rel="stylesheet" type="text/css">
  <link href="./Lattice Boltzmann Method - Andrew Gibiansky_files/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script type="text/javascript" async="" src="./Lattice Boltzmann Method - Andrew Gibiansky_files/ga.js.download"></script><script src="./Lattice Boltzmann Method - Andrew Gibiansky_files/jquery.min.js.download"></script>

  <script type="text/javascript">
  window.MathJax = {
      tex2jax: {
        // Hack for Hakyll. Char code 86 is a dollar sign, which is used in templates...
        inlineMath: [ [String.fromCharCode(36), String.fromCharCode(36)], ["\\(","\\)"] ],
        processEscapes: true
      }
  };
  </script>
  <script src="./Lattice Boltzmann Method - Andrew Gibiansky_files/MathJax.js.download" id=""></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>

  <style>
  table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
      margin: 0;
      padding: 0;
      vertical-align: baseline;
      border: none;
  }
  table.sourceCode { 
      width: 100%;
      background-color: #2a211c;
      color: #bdae9d;

      line-height: 1.4;
      font-size: 0.8em;
  }
  td.lineNumbers { 
      text-align: right;
      padding-right: 4px;
      padding-left: 4px;
      background-color: #2a211c;
      color: #bdae9d;
      border-right: 1px solid #bdae9d;
  }
  td.sourceCode { 
      padding-left: 5px;
  }

  pre.sourceCode, code.sourceCode { 
      color: #bdbdbd;
      background-color: #000000;
  }

  code > span.dt { text-decoration: underline; }
  code > span.dv { color: #44aa43; }
  code > span.bn { color: #44aa43; }
  code > span.fl { color: #44aa43; }
  code > span.ch { color: #049b0a; }
  code > span.st { color: #049b0a; }
  code > span.al { color: #ffff00; }
  code > span.er { font-weight: bold; }

  code > span.co {
      color: #ee5555;
      font-style: italic;
  }
  code > span.fu { 
      color: #ff9358;
      font-weight: bold;
  }
  code > span.kw { 
      color: #43a8ed;
      font-weight: bold;
  }
  </style>

  <style>
  .center {
      text-align: center;
  }
  .gist .line-data { width: 100% }

  .entry-content figure {
    display: block;
    margin-left: auto;
    margin-right: auto;
    text-align: center;
    margin-bottom: 1em;
    margin-top: 1em;
  }
  </style>

  
  <link href="./Lattice Boltzmann Method - Andrew Gibiansky_files/ipython.css" rel="stylesheet" type="text/css">
  <style>
div.input_area {
    border: none;
}
div.output_area { display: block; }
.output_area > .output_subarea { display: inline-block; }
.output_area > .prompt { display: inline-block; }
  </style>
  

  <script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-40714888-1']);
_gaq.push(['_trackPageview']);

(function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>

<style type="text/css">#xLabsCanvas{pointer-events:none;top:0;left:0;position:fixed;z-index:2147483646;}#xLabsCanvas.allow-pointer{pointer-events:auto;}</style><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.1') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>

<body class="vsc-initialized"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>
  <header role="banner">
    <hgroup>
      <h1>
        <a href="http://andrew.gibiansky.com/">
          Andrew Gibiansky
          &nbsp;&nbsp;::&nbsp;
          &nbsp;<em>Math</em>&nbsp;→&nbsp;[<strong>Code</strong>]
        </a>
      </h1>
    </hgroup>
  </header>
  <nav role="navigation"><ul class="main-navigation">
  <li><a href="http://andrew.gibiansky.com/">Blog</a></li>
  <li><a href="http://andrew.gibiansky.com/archive.html">Archive</a></li>
  <li><a href="http://andrew.gibiansky.com/pages/about.html">About</a></li>
</ul>
</nav>
  <div id="main">
    <div id="content">
        <div>
<article class="hentry" role="article">

  <header>
    <!--
    <div style="text-align: center; font-weight: bold; font-size: 1.3em; border-width: 2px; border-style: solid; border-radius: 20px; padding: 0.5em; background: none repeat scroll 0% 0% rgba(225, 68, 68, 0.2); overflow: hidden;"><div><img style="float: left; width: 70px; border: none; box-shadow: none;" src="http://www.kronosnotebook.com/static/imgs/logo.png" alt="Kronos Notebook logo"> <div style="">Check out <a href="http://www.kronosnotebook.com">Kronos Notebook</a>, my new <a href="http://www.ipython.org/notebook.html">IPython</a>-based Mac app for interactive computing and data analysis in Python or Haskell.</div></div></div> -->

    <h1 class="entry-title">Lattice Boltzmann Method</h1>

    <p class="meta">
    Friday, December 19, 2014
    </p>
</header>


<div class="entry-content">
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Historically, fluid simulation methods have relied on a discretization of a 3-dimensional partial differential equation representing motion in a continuum. However, an alternative modern approach relies instead on viewing fluids from a statistical mechanics point of view, treating them as a set of particles with probability distributions on their locations and velocities and simulating the evolution of these distributions.</p>
<p>We begin by briefly deriving the Navier-Stokes equations for incompressible fluid flow; then, we take a look at an alternative approach via the Boltzmann transport equation; finally, we implement a discretization of the transport equation in a modern simulation technique known as the <a href="http://www.cims.nyu.edu/~billbao/report930.pdf">Lattice Boltzmann Method</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Navier-Stokes-Equations">Navier Stokes Equations<a class="anchor-link" href="http://andrew.gibiansky.com/blog/physics/lattice-boltzmann-method/#Navier-Stokes-Equations"></a></h2><p>The Navier-Stokes equations in their most basic form can be derived from a fairly simple physical standpoint, relying only on local conservation of mass and momentum. Extending the resulting equations to differnt fluids and circumstances requires substantial physical modeling, but the equations for Newtonian incompressible fluids are somewhat straightforward.</p>
<h3 id="Local-Consveration-of-Mass">Local Consveration of Mass<a class="anchor-link" href="http://andrew.gibiansky.com/blog/physics/lattice-boltzmann-method/#Local-Consveration-of-Mass"></a></h3><p>First, consider the mass of fluid (of density <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 2.232em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.907em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.396em, 1001.81em, 2.65em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math-italic;">ρ</span><span class="mo" id="MathJax-Span-4" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-5"><span class="mrow" id="MathJax-Span-6"><span class="mi" id="MathJax-Span-7" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-8" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.323em; border-left: 0px solid; width: 0px; height: 1.307em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ρ</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-1">\rho({\bf x})</script>) within some control volume <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A9;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-9" style="width: 0.885em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.746em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.442em, 1000.7em, 2.418em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-10"><span class="mi" id="MathJax-Span-11" style="font-family: MathJax_Main;">Ω</span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Ω</mi></math></span></span><script type="math/tex" id="MathJax-Element-2">\Omega</script>. The total mass within the volume is given by the integral
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A9;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;&amp;#x03C1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-12" style="width: 8.178em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.97em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(0.792em, 1006.97em, 3.3em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-13"><span class="mi" id="MathJax-Span-14" style="font-family: MathJax_Math-italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span class="mo" id="MathJax-Span-15" style="font-family: MathJax_Main; padding-left: 0.281em;">=</span><span class="msubsup" id="MathJax-Span-16" style="padding-left: 0.281em;"><span style="display: inline-block; position: relative; width: 1.164em; height: 0px;"><span style="position: absolute; clip: rect(2.511em, 1000.93em, 5.019em, -999.998em); top: -3.992em; left: 0em;"><span class="mo" id="MathJax-Span-17" style="font-family: MathJax_Size2; vertical-align: 0.002em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.374em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.11em; left: 0.56em;"><span class="mi" id="MathJax-Span-18" style="font-size: 70.7%; font-family: MathJax_Main;">Ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mi" id="MathJax-Span-19" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">ρ</span><span class="mo" id="MathJax-Span-20" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-21"><span class="mrow" id="MathJax-Span-22"><span class="mi" id="MathJax-Span-23" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-24" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-25" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-26" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.188em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.084em; border-left: 0px solid; width: 0px; height: 2.774em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>M</mi><mo>=</mo><msub><mo>∫</mo><mi mathvariant="normal">Ω</mi></msub><mi>ρ</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo><mi>d</mi><mi>V</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-3">M = \int_\Omega \rho({\bf x}) dV</script>
As mass is conserved, we know that mass can only change via an influx or an outflux of fluid, which can occur either from a source or sink within the control volume or from flow in or out of the control volume. We can formalize this by expressing the derivative of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-27" style="width: 1.257em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.396em, 1001.07em, 2.371em, -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-28"><span class="mi" id="MathJax-Span-29" style="font-family: MathJax_Math-italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi></math></span></span><script type="math/tex" id="MathJax-Element-4">M</script> with respect to time:</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mfrac&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;msub&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A9;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;&amp;#x03C1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A9;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi&gt;&amp;#x03C1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A9;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-30" style="width: 23.181em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.791em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(0.746em, 1019.79em, 3.3em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-31"><span class="mfrac" id="MathJax-Span-32"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1000.51em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.276em;"><span class="mi" id="MathJax-Span-33" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1000.84em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.462em;"><span class="mrow" id="MathJax-Span-34"><span class="mi" id="MathJax-Span-35" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-36" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1001.02em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.024em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-37" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.164em; height: 0px;"><span style="position: absolute; clip: rect(2.511em, 1000.93em, 5.019em, -999.998em); top: -3.992em; left: 0em;"><span class="mo" id="MathJax-Span-38" style="font-family: MathJax_Size2; vertical-align: 0.002em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.374em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.11em; left: 0.56em;"><span class="mi" id="MathJax-Span-39" style="font-size: 70.7%; font-family: MathJax_Main;">Ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mi" id="MathJax-Span-40" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">ρ</span><span class="mo" id="MathJax-Span-41" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-42"><span class="mrow" id="MathJax-Span-43"><span class="mi" id="MathJax-Span-44" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-45" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-46" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-47" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.188em;"></span></span><span class="mo" id="MathJax-Span-48" style="font-family: MathJax_Main; padding-left: 0.281em;">=</span><span class="mo" id="MathJax-Span-49" style="font-family: MathJax_Main; padding-left: 0.281em;">−</span><span class="msubsup" id="MathJax-Span-50" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.442em; height: 0px;"><span style="position: absolute; clip: rect(2.511em, 1000.93em, 5.019em, -999.998em); top: -3.992em; left: 0em;"><span class="mo" id="MathJax-Span-51" style="font-family: MathJax_Size2; vertical-align: 0.002em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.374em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.11em; left: 0.56em;"><span class="texatom" id="MathJax-Span-52"><span class="mrow" id="MathJax-Span-53"><span class="mi" id="MathJax-Span-54" style="font-size: 70.7%; font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-55" style="font-size: 70.7%; font-family: MathJax_Main;">Ω</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mi" id="MathJax-Span-56" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">ρ</span><span class="mo" id="MathJax-Span-57" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-58"><span class="mrow" id="MathJax-Span-59"><span class="mi" id="MathJax-Span-60" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-61" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-62"><span class="mrow" id="MathJax-Span-63"><span class="mi" id="MathJax-Span-64" style="font-family: MathJax_Main-bold;">v</span></span></span><span class="mo" id="MathJax-Span-65" style="font-family: MathJax_Main; padding-left: 0.235em;">⋅</span><span class="texatom" id="MathJax-Span-66" style="padding-left: 0.235em;"><span class="mrow" id="MathJax-Span-67"><span class="mi" id="MathJax-Span-68" style="font-family: MathJax_Main-bold;">n</span></span></span><span class="mi" id="MathJax-Span-69" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-70" style="font-family: MathJax_Math-italic;">A</span><span class="mo" id="MathJax-Span-71" style="font-family: MathJax_Main; padding-left: 0.235em;">−</span><span class="msubsup" id="MathJax-Span-72" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.164em; height: 0px;"><span style="position: absolute; clip: rect(2.511em, 1000.93em, 5.019em, -999.998em); top: -3.992em; left: 0em;"><span class="mo" id="MathJax-Span-73" style="font-family: MathJax_Size2; vertical-align: 0.002em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.374em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.11em; left: 0.56em;"><span class="mi" id="MathJax-Span-74" style="font-size: 70.7%; font-family: MathJax_Main;">Ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mi" id="MathJax-Span-75" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">Q</span><span class="mi" id="MathJax-Span-76" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-77" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.188em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.084em; border-left: 0px solid; width: 0px; height: 2.774em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mi>d</mi><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><msub><mo>∫</mo><mi mathvariant="normal">Ω</mi></msub><mi>ρ</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo><mi>d</mi><mi>V</mi><mo>=</mo><mo>−</mo><msub><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mi>δ</mi><mi mathvariant="normal">Ω</mi></mrow></msub><mi>ρ</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mo>⋅</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">n</mi></mrow><mi>d</mi><mi>A</mi><mo>−</mo><msub><mo>∫</mo><mi mathvariant="normal">Ω</mi></msub><mi>Q</mi><mi>d</mi><mi>V</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-5">\frac{d}{dt} \int_\Omega \rho({\bf x}) dV = -\int_{\delta \Omega} \rho({\bf x}) {\bf v}\cdot {\bf n} d A - \int_\Omega Q d V</script></p>
<p>In the equation above, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-78" style="width: 0.931em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.792em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.396em, 1000.75em, 2.557em, -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-79"><span class="mi" id="MathJax-Span-80" style="font-family: MathJax_Math-italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 1.144em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-6">Q</script> represents a general source or sink term, which we can assume to be zero if we have no flow in or out of our system. The integral over the boundary <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A9;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-81" style="width: 1.396em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.164em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.442em, 1001.12em, 2.418em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-82"><span class="mi" id="MathJax-Span-83" style="font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-84" style="font-family: MathJax_Main;">Ω</span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.981em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>δ</mi><mi mathvariant="normal">Ω</mi></math></span></span><script type="math/tex" id="MathJax-Element-7">\delta \Omega</script> represents the flow in or out of the boundary, and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-85" style="width: 0.746em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.606em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.675em, 1000.56em, 2.418em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-86"><span class="texatom" id="MathJax-Span-87"><span class="mrow" id="MathJax-Span-88"><span class="mi" id="MathJax-Span-89" style="font-family: MathJax_Main-bold;">v</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.655em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-8">{\bf v}</script> is the velocity at <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-90" style="width: 0.746em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.606em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.675em, 1000.61em, 2.418em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-91"><span class="texatom" id="MathJax-Span-92"><span class="mrow" id="MathJax-Span-93"><span class="mi" id="MathJax-Span-94" style="font-family: MathJax_Main-bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.655em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-9">{\bf x}</script>. Applying the divergence theorem to the surface integral, we find that
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mfrac&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;msub&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A9;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;&amp;#x03C1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A9;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-95" style="width: 20.952em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.886em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(0.746em, 1017.89em, 3.3em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-96"><span class="mfrac" id="MathJax-Span-97"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1000.51em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.276em;"><span class="mi" id="MathJax-Span-98" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1000.84em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.462em;"><span class="mrow" id="MathJax-Span-99"><span class="mi" id="MathJax-Span-100" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-101" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1001.02em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.024em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-102" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.164em; height: 0px;"><span style="position: absolute; clip: rect(2.511em, 1000.93em, 5.019em, -999.998em); top: -3.992em; left: 0em;"><span class="mo" id="MathJax-Span-103" style="font-family: MathJax_Size2; vertical-align: 0.002em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.374em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.11em; left: 0.56em;"><span class="mi" id="MathJax-Span-104" style="font-size: 70.7%; font-family: MathJax_Main;">Ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mi" id="MathJax-Span-105" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">ρ</span><span class="mo" id="MathJax-Span-106" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-107"><span class="mrow" id="MathJax-Span-108"><span class="mi" id="MathJax-Span-109" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-110" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-111" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-112" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.188em;"></span></span><span class="mo" id="MathJax-Span-113" style="font-family: MathJax_Main; padding-left: 0.281em;">=</span><span class="mo" id="MathJax-Span-114" style="font-family: MathJax_Main; padding-left: 0.281em;">−</span><span class="msubsup" id="MathJax-Span-115" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.164em; height: 0px;"><span style="position: absolute; clip: rect(2.511em, 1000.93em, 5.019em, -999.998em); top: -3.992em; left: 0em;"><span class="mo" id="MathJax-Span-116" style="font-family: MathJax_Size2; vertical-align: 0.002em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.374em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.11em; left: 0.56em;"><span class="texatom" id="MathJax-Span-117"><span class="mrow" id="MathJax-Span-118"><span class="mi" id="MathJax-Span-119" style="font-size: 70.7%; font-family: MathJax_Main;">Ω</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mi" id="MathJax-Span-120" style="font-family: MathJax_Main; padding-left: 0.188em;">∇</span><span class="mo" id="MathJax-Span-121" style="font-family: MathJax_Main; padding-left: 0.235em;">⋅</span><span class="mo" id="MathJax-Span-122" style="font-family: MathJax_Main; padding-left: 0.235em;">(</span><span class="mi" id="MathJax-Span-123" style="font-family: MathJax_Math-italic;">ρ</span><span class="mo" id="MathJax-Span-124" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-125"><span class="mrow" id="MathJax-Span-126"><span class="mi" id="MathJax-Span-127" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-128" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-129"><span class="mrow" id="MathJax-Span-130"><span class="mi" id="MathJax-Span-131" style="font-family: MathJax_Main-bold;">v</span></span></span><span class="mo" id="MathJax-Span-132" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-133" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="mi" id="MathJax-Span-134" style="font-family: MathJax_Math-italic; padding-left: 0.235em;">Q</span><span class="mi" id="MathJax-Span-135" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-136" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.188em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.084em; border-left: 0px solid; width: 0px; height: 2.774em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mi>d</mi><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><msub><mo>∫</mo><mi mathvariant="normal">Ω</mi></msub><mi>ρ</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo><mi>d</mi><mi>V</mi><mo>=</mo><mo>−</mo><msub><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">Ω</mi></mrow></msub><mi mathvariant="normal">∇</mi><mo>⋅</mo><mo stretchy="false">(</mo><mi>ρ</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mo stretchy="false">)</mo><mo>+</mo><mi>Q</mi><mi>d</mi><mi>V</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-10">\frac{d}{dt} \int_\Omega \rho({\bf x}) dV = -\int_{\Omega}\nabla\cdot (\rho({\bf x}) {\bf v}) + QdV</script>
If we flip the order of integration with the derivative, we find that we get the entire equation under the same integral, yielding
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A9;&lt;/mi&gt;&lt;/msub&gt;&lt;mfrac&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mi&gt;&amp;#x03C1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-137" style="width: 18.536em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.842em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(0.746em, 1015.8em, 3.3em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-138"><span class="msubsup" id="MathJax-Span-139"><span style="display: inline-block; position: relative; width: 1.164em; height: 0px;"><span style="position: absolute; clip: rect(2.511em, 1000.93em, 5.019em, -999.998em); top: -3.992em; left: 0em;"><span class="mo" id="MathJax-Span-140" style="font-family: MathJax_Size2; vertical-align: 0.002em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.374em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.11em; left: 0.56em;"><span class="mi" id="MathJax-Span-141" style="font-size: 70.7%; font-family: MathJax_Main;">Ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-142" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1000.51em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.276em;"><span class="mi" id="MathJax-Span-143" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1000.84em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.462em;"><span class="mrow" id="MathJax-Span-144"><span class="mi" id="MathJax-Span-145" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-146" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1001.02em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.024em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mi" id="MathJax-Span-147" style="font-family: MathJax_Math-italic;">ρ</span><span class="mo" id="MathJax-Span-148" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-149"><span class="mrow" id="MathJax-Span-150"><span class="mi" id="MathJax-Span-151" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-152" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-153" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="mi" id="MathJax-Span-154" style="font-family: MathJax_Main; padding-left: 0.235em;">∇</span><span class="mo" id="MathJax-Span-155" style="font-family: MathJax_Main; padding-left: 0.235em;">⋅</span><span class="mo" id="MathJax-Span-156" style="font-family: MathJax_Main; padding-left: 0.235em;">(</span><span class="mi" id="MathJax-Span-157" style="font-family: MathJax_Math-italic;">ρ</span><span class="mo" id="MathJax-Span-158" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-159"><span class="mrow" id="MathJax-Span-160"><span class="mi" id="MathJax-Span-161" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-162" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-163"><span class="mrow" id="MathJax-Span-164"><span class="mi" id="MathJax-Span-165" style="font-family: MathJax_Main-bold;">v</span></span></span><span class="mo" id="MathJax-Span-166" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-167" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="mi" id="MathJax-Span-168" style="font-family: MathJax_Math-italic; padding-left: 0.235em;">Q</span><span class="mi" id="MathJax-Span-169" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-170" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.188em;"></span></span><span class="mo" id="MathJax-Span-171" style="font-family: MathJax_Main; padding-left: 0.281em;">=</span><span class="mn" id="MathJax-Span-172" style="font-family: MathJax_Main; padding-left: 0.281em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.084em; border-left: 0px solid; width: 0px; height: 2.774em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mo>∫</mo><mi mathvariant="normal">Ω</mi></msub><mfrac><mi>d</mi><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mi>ρ</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo><mo>+</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><mo stretchy="false">(</mo><mi>ρ</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mo stretchy="false">)</mo><mo>+</mo><mi>Q</mi><mi>d</mi><mi>V</mi><mo>=</mo><mn>0</mn></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-11"> \int_\Omega \frac{d}{dt}\rho({\bf x}) +\nabla\cdot (\rho({\bf x}) {\bf v}) + QdV = 0</script>
Since this applies to <em>any</em> control volume <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A9;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-173" style="width: 0.885em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.746em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.442em, 1000.7em, 2.418em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-174"><span class="mi" id="MathJax-Span-175" style="font-family: MathJax_Main;">Ω</span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Ω</mi></math></span></span><script type="math/tex" id="MathJax-Element-12">\Omega</script>, the integrand itself must be zero; this assertion is equivalent to stating that mass must be <em>locally</em> conserved:
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mfrac&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mi&gt;&amp;#x03C1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-176" style="width: 15.471em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.194em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(0.746em, 1013.15em, 3.115em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-177"><span class="mfrac" id="MathJax-Span-178"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1000.51em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.276em;"><span class="mi" id="MathJax-Span-179" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1000.84em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.462em;"><span class="mrow" id="MathJax-Span-180"><span class="mi" id="MathJax-Span-181" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-182" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1001.02em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.024em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mi" id="MathJax-Span-183" style="font-family: MathJax_Math-italic;">ρ</span><span class="mo" id="MathJax-Span-184" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-185"><span class="mrow" id="MathJax-Span-186"><span class="mi" id="MathJax-Span-187" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-188" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-189" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="mi" id="MathJax-Span-190" style="font-family: MathJax_Main; padding-left: 0.235em;">∇</span><span class="mo" id="MathJax-Span-191" style="font-family: MathJax_Main; padding-left: 0.235em;">⋅</span><span class="mo" id="MathJax-Span-192" style="font-family: MathJax_Main; padding-left: 0.235em;">(</span><span class="mi" id="MathJax-Span-193" style="font-family: MathJax_Math-italic;">ρ</span><span class="mo" id="MathJax-Span-194" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-195"><span class="mrow" id="MathJax-Span-196"><span class="mi" id="MathJax-Span-197" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-198" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-199"><span class="mrow" id="MathJax-Span-200"><span class="mi" id="MathJax-Span-201" style="font-family: MathJax_Main-bold;">v</span></span></span><span class="mo" id="MathJax-Span-202" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-203" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="mi" id="MathJax-Span-204" style="font-family: MathJax_Math-italic; padding-left: 0.235em;">Q</span><span class="mo" id="MathJax-Span-205" style="font-family: MathJax_Main; padding-left: 0.281em;">=</span><span class="mn" id="MathJax-Span-206" style="font-family: MathJax_Main; padding-left: 0.281em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.867em; border-left: 0px solid; width: 0px; height: 2.557em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mi>d</mi><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mi>ρ</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo><mo>+</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><mo stretchy="false">(</mo><mi>ρ</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mo stretchy="false">)</mo><mo>+</mo><mi>Q</mi><mo>=</mo><mn>0</mn></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-13">\frac{d}{dt}\rho({\bf x}) +\nabla\cdot (\rho({\bf x}) {\bf v}) + Q = 0</script>
If we assume no sources or sinks, we get a simple and elegant equation for the local conservation of mass:
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03C1;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C1;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-207" style="width: 8.364em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.156em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.396em, 1007.11em, 2.65em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-208"><span class="texatom" id="MathJax-Span-209"><span class="mrow" id="MathJax-Span-210"><span class="munderover" id="MathJax-Span-211"><span style="display: inline-block; position: relative; width: 0.606em; height: 0px;"><span style="position: absolute; clip: rect(3.393em, 1000.51em, 4.369em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-212" style="font-family: MathJax_Math-italic;">ρ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.207em, 1000.33em, 3.579em, -999.998em); top: -3.992em; left: 0.095em;"><span class="mo" id="MathJax-Span-213" style="font-family: MathJax_Main;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-214" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="mi" id="MathJax-Span-215" style="font-family: MathJax_Main; padding-left: 0.235em;">∇</span><span class="mo" id="MathJax-Span-216" style="font-family: MathJax_Main; padding-left: 0.235em;">⋅</span><span class="mo" id="MathJax-Span-217" style="font-family: MathJax_Main; padding-left: 0.235em;">(</span><span class="mi" id="MathJax-Span-218" style="font-family: MathJax_Math-italic;">ρ</span><span class="texatom" id="MathJax-Span-219"><span class="mrow" id="MathJax-Span-220"><span class="mi" id="MathJax-Span-221" style="font-family: MathJax_Main-bold;">v</span></span></span><span class="mo" id="MathJax-Span-222" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-223" style="font-family: MathJax_Main; padding-left: 0.281em;">=</span><span class="mn" id="MathJax-Span-224" style="font-family: MathJax_Main; padding-left: 0.281em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.323em; border-left: 0px solid; width: 0px; height: 1.307em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mover><mi>ρ</mi><mo>˙</mo></mover></mrow><mo>+</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><mo stretchy="false">(</mo><mi>ρ</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-14">\dot{\rho} +\nabla\cdot (\rho {\bf v}) = 0</script></p>
<h3 id="Local-Conservation-of-Momentum">Local Conservation of Momentum<a class="anchor-link" href="http://andrew.gibiansky.com/blog/physics/lattice-boltzmann-method/#Local-Conservation-of-Momentum"></a></h3><p>We begin by recalling Newton's third law relating force and acceleration:
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-225" style="width: 4.415em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.765em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.442em, 1003.67em, 2.418em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-226"><span class="texatom" id="MathJax-Span-227"><span class="mrow" id="MathJax-Span-228"><span class="mi" id="MathJax-Span-229" style="font-family: MathJax_Main-bold;">F</span></span></span><span class="mo" id="MathJax-Span-230" style="font-family: MathJax_Main; padding-left: 0.281em;">=</span><span class="mi" id="MathJax-Span-231" style="font-family: MathJax_Math-italic; padding-left: 0.281em;">m</span><span class="texatom" id="MathJax-Span-232"><span class="mrow" id="MathJax-Span-233"><span class="mi" id="MathJax-Span-234" style="font-family: MathJax_Main-bold;">a</span></span></span><span class="mo" id="MathJax-Span-235" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">F</mi></mrow><mo>=</mo><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">a</mi></mrow><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-15">{\bf F} = m {\bf a}.</script>
We can put this in continuum form, expressing it with densities instead and assuming some "body force" <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-236" style="width: 0.792em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.442em, 1000.61em, 2.418em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-237"><span class="mi" id="MathJax-Span-238" style="font-family: MathJax_Main-bold;">b</span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold">b</mi></math></span></span><script type="math/tex" id="MathJax-Element-16">\bf b</script>:
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03C1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-239" style="width: 7.156em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.087em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(0.746em, 1006em, 3.115em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-240"><span class="texatom" id="MathJax-Span-241"><span class="mrow" id="MathJax-Span-242"><span class="mi" id="MathJax-Span-243" style="font-family: MathJax_Main-bold;">b</span></span></span><span class="mo" id="MathJax-Span-244" style="font-family: MathJax_Main; padding-left: 0.281em;">=</span><span class="mi" id="MathJax-Span-245" style="font-family: MathJax_Math-italic; padding-left: 0.281em;">ρ</span><span class="mo" id="MathJax-Span-246" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-247"><span class="mrow" id="MathJax-Span-248"><span class="mi" id="MathJax-Span-249" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-250" style="font-family: MathJax_Main;">)</span><span class="mfrac" id="MathJax-Span-251"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1000.51em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.276em;"><span class="mi" id="MathJax-Span-252" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1000.84em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.462em;"><span class="mrow" id="MathJax-Span-253"><span class="mi" id="MathJax-Span-254" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-255" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1001.02em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.024em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="texatom" id="MathJax-Span-256"><span class="mrow" id="MathJax-Span-257"><span class="mi" id="MathJax-Span-258" style="font-family: MathJax_Main-bold;">v</span></span></span><span class="mo" id="MathJax-Span-259" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.867em; border-left: 0px solid; width: 0px; height: 2.557em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">b</mi></mrow><mo>=</mo><mi>ρ</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo><mfrac><mi>d</mi><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-17">{\bf b} = \rho({\bf x}) \frac{d}{dt}{\bf v}.</script>
Next, expand the acceleration by substituting in the full derivative:
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mfrac&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-260" style="width: 28.941em; display: inline-block;"><span style="display: inline-block; position: relative; width: 24.714em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(0.746em, 1024.67em, 3.3em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-261"><span class="mfrac" id="MathJax-Span-262"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1000.51em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.276em;"><span class="mi" id="MathJax-Span-263" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1000.84em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.462em;"><span class="mrow" id="MathJax-Span-264"><span class="mi" id="MathJax-Span-265" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-266" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1001.02em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.024em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="texatom" id="MathJax-Span-267"><span class="mrow" id="MathJax-Span-268"><span class="mi" id="MathJax-Span-269" style="font-family: MathJax_Main-bold;">v</span></span></span><span class="mo" id="MathJax-Span-270" style="font-family: MathJax_Main; padding-left: 0.281em;">=</span><span class="mfrac" id="MathJax-Span-271" style="padding-left: 0.281em;"><span style="display: inline-block; position: relative; width: 1.303em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1001.16em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.602em;"><span class="mrow" id="MathJax-Span-272"><span class="mi" id="MathJax-Span-273" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="texatom" id="MathJax-Span-274"><span class="mrow" id="MathJax-Span-275"><span class="mi" id="MathJax-Span-276" style="font-family: MathJax_Main-bold;">v</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1000.88em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.462em;"><span class="mrow" id="MathJax-Span-277"><span class="mi" id="MathJax-Span-278" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mi" id="MathJax-Span-279" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1001.3em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.303em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mo" id="MathJax-Span-280" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="mfrac" id="MathJax-Span-281" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.303em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1001.16em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.602em;"><span class="mrow" id="MathJax-Span-282"><span class="mi" id="MathJax-Span-283" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="texatom" id="MathJax-Span-284"><span class="mrow" id="MathJax-Span-285"><span class="mi" id="MathJax-Span-286" style="font-family: MathJax_Main-bold;">v</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1001.07em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.555em;"><span class="mrow" id="MathJax-Span-287"><span class="mi" id="MathJax-Span-288" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mi" id="MathJax-Span-289" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1001.3em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.303em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-290"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1001.07em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.555em;"><span class="mrow" id="MathJax-Span-291"><span class="mi" id="MathJax-Span-292" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mi" id="MathJax-Span-293" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1000.88em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.462em;"><span class="mrow" id="MathJax-Span-294"><span class="mi" id="MathJax-Span-295" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mi" id="MathJax-Span-296" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1001.26em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.257em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mo" id="MathJax-Span-297" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="mfrac" id="MathJax-Span-298" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.303em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1001.16em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.602em;"><span class="mrow" id="MathJax-Span-299"><span class="mi" id="MathJax-Span-300" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="texatom" id="MathJax-Span-301"><span class="mrow" id="MathJax-Span-302"><span class="mi" id="MathJax-Span-303" style="font-family: MathJax_Main-bold;">v</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1001.07em, 4.322em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.509em;"><span class="mrow" id="MathJax-Span-304"><span class="mi" id="MathJax-Span-305" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mi" id="MathJax-Span-306" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1001.3em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.303em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-307"><span style="display: inline-block; position: relative; width: 1.164em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1001.07em, 4.322em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.509em;"><span class="mrow" id="MathJax-Span-308"><span class="mi" id="MathJax-Span-309" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mi" id="MathJax-Span-310" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1000.88em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.462em;"><span class="mrow" id="MathJax-Span-311"><span class="mi" id="MathJax-Span-312" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mi" id="MathJax-Span-313" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1001.16em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.164em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mo" id="MathJax-Span-314" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="mfrac" id="MathJax-Span-315" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.303em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1001.16em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.602em;"><span class="mrow" id="MathJax-Span-316"><span class="mi" id="MathJax-Span-317" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="texatom" id="MathJax-Span-318"><span class="mrow" id="MathJax-Span-319"><span class="mi" id="MathJax-Span-320" style="font-family: MathJax_Main-bold;">v</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1001.02em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.509em;"><span class="mrow" id="MathJax-Span-321"><span class="mi" id="MathJax-Span-322" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mi" id="MathJax-Span-323" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1001.3em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.303em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-324"><span style="display: inline-block; position: relative; width: 1.164em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1001.02em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.509em;"><span class="mrow" id="MathJax-Span-325"><span class="mi" id="MathJax-Span-326" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mi" id="MathJax-Span-327" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1000.88em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.462em;"><span class="mrow" id="MathJax-Span-328"><span class="mi" id="MathJax-Span-329" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mi" id="MathJax-Span-330" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1001.16em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.164em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mo" id="MathJax-Span-331" style="font-family: MathJax_Main; padding-left: 0.281em;">=</span><span class="mfrac" id="MathJax-Span-332" style="padding-left: 0.281em;"><span style="display: inline-block; position: relative; width: 1.303em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1001.16em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.602em;"><span class="mrow" id="MathJax-Span-333"><span class="mi" id="MathJax-Span-334" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="texatom" id="MathJax-Span-335"><span class="mrow" id="MathJax-Span-336"><span class="mi" id="MathJax-Span-337" style="font-family: MathJax_Main-bold;">v</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1000.88em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.462em;"><span class="mrow" id="MathJax-Span-338"><span class="mi" id="MathJax-Span-339" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mi" id="MathJax-Span-340" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1001.3em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.303em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mo" id="MathJax-Span-341" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="mi" id="MathJax-Span-342" style="font-family: MathJax_Main; padding-left: 0.235em;">∇</span><span class="texatom" id="MathJax-Span-343"><span class="mrow" id="MathJax-Span-344"><span class="mi" id="MathJax-Span-345" style="font-family: MathJax_Main-bold;">v</span></span></span><span class="mo" id="MathJax-Span-346" style="font-family: MathJax_Main; padding-left: 0.235em;">⋅</span><span class="texatom" id="MathJax-Span-347" style="padding-left: 0.235em;"><span class="mrow" id="MathJax-Span-348"><span class="mi" id="MathJax-Span-349" style="font-family: MathJax_Main-bold;">v</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.084em; border-left: 0px solid; width: 0px; height: 2.774em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mi>d</mi><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><mi>z</mi></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>z</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mo>⋅</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-18">\newcommand\p[2]{\frac{\partial #1}{\partial #2}}
\newcommand\vv{{\bf v}}
\frac{d}{dt}\vv = \p{\vv}{t} + \p{\vv}{x}\p{x}{t} + \p{\vv}{y}\p{y}{t} + \p{\vv}{z}\p{z}{t}
= \p{\vv}{t} + \nabla \vv \cdot \vv</script>
This yields the equation for local conservation of momentum:
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03C1;&lt;/mi&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03C1;&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-350" style="width: 10.454em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.921em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(0.746em, 1008.83em, 3.115em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-351"><span class="texatom" id="MathJax-Span-352"><span class="mrow" id="MathJax-Span-353"><span class="mi" id="MathJax-Span-354" style="font-family: MathJax_Main-bold;">b</span></span></span><span class="mo" id="MathJax-Span-355" style="font-family: MathJax_Main; padding-left: 0.281em;">=</span><span class="mi" id="MathJax-Span-356" style="font-family: MathJax_Math-italic; padding-left: 0.281em;">ρ</span><span class="mfrac" id="MathJax-Span-357"><span style="display: inline-block; position: relative; width: 1.303em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1001.16em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.602em;"><span class="mrow" id="MathJax-Span-358"><span class="mi" id="MathJax-Span-359" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="texatom" id="MathJax-Span-360"><span class="mrow" id="MathJax-Span-361"><span class="mi" id="MathJax-Span-362" style="font-family: MathJax_Main-bold;">v</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1000.88em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.462em;"><span class="mrow" id="MathJax-Span-363"><span class="mi" id="MathJax-Span-364" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mi" id="MathJax-Span-365" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1001.3em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.303em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mo" id="MathJax-Span-366" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="mi" id="MathJax-Span-367" style="font-family: MathJax_Math-italic; padding-left: 0.235em;">ρ</span><span class="mi" id="MathJax-Span-368" style="font-family: MathJax_Main;">∇</span><span class="texatom" id="MathJax-Span-369"><span class="mrow" id="MathJax-Span-370"><span class="mi" id="MathJax-Span-371" style="font-family: MathJax_Main-bold;">v</span></span></span><span class="mo" id="MathJax-Span-372" style="font-family: MathJax_Main; padding-left: 0.235em;">⋅</span><span class="texatom" id="MathJax-Span-373" style="padding-left: 0.235em;"><span class="mrow" id="MathJax-Span-374"><span class="mi" id="MathJax-Span-375" style="font-family: MathJax_Main-bold;">v</span></span></span><span class="mo" id="MathJax-Span-376" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.867em; border-left: 0px solid; width: 0px; height: 2.557em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">b</mi></mrow><mo>=</mo><mi>ρ</mi><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mi>ρ</mi><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mo>⋅</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-19">{\bf b} = \rho\p{\vv}{t} + \rho\nabla \vv \cdot \vv.</script></p>
<h3 id="Next-Steps">Next Steps<a class="anchor-link" href="http://andrew.gibiansky.com/blog/physics/lattice-boltzmann-method/#Next-Steps"></a></h3><p>We've derived a pair of equations for conservation of fluid mass and momentum:
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03C1;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C1;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;&amp;#x03C1;&lt;/mi&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03C1;&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-377" style="width: 10.5em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.967em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(0.095em, 1008.74em, 3.858em, -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-378"><span class="mtable" id="MathJax-Span-379" style="padding-right: 0.188em; padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 8.596em; height: 0px;"><span style="position: absolute; clip: rect(2.371em, 1006.6em, 6.041em, -999.998em); top: -4.411em; left: 0em;"><span style="display: inline-block; position: relative; width: 6.598em; height: 0px;"><span style="position: absolute; clip: rect(3.115em, 1005.25em, 4.369em, -999.998em); top: -5.154em; right: 0em;"><span class="mtd" id="MathJax-Span-380"><span class="mrow" id="MathJax-Span-381"><span class="texatom" id="MathJax-Span-382"><span class="mrow" id="MathJax-Span-383"><span class="munderover" id="MathJax-Span-384"><span style="display: inline-block; position: relative; width: 0.606em; height: 0px;"><span style="position: absolute; clip: rect(3.393em, 1000.51em, 4.369em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-385" style="font-family: MathJax_Math-italic;">ρ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.207em, 1000.33em, 3.579em, -999.998em); top: -3.992em; left: 0.095em;"><span class="mo" id="MathJax-Span-386" style="font-family: MathJax_Main;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-387" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="mi" id="MathJax-Span-388" style="font-family: MathJax_Main; padding-left: 0.235em;">∇</span><span class="mo" id="MathJax-Span-389" style="font-family: MathJax_Main; padding-left: 0.235em;">⋅</span><span class="mo" id="MathJax-Span-390" style="font-family: MathJax_Main; padding-left: 0.235em;">(</span><span class="mi" id="MathJax-Span-391" style="font-family: MathJax_Math-italic;">ρ</span><span class="texatom" id="MathJax-Span-392"><span class="mrow" id="MathJax-Span-393"><span class="mi" id="MathJax-Span-394" style="font-family: MathJax_Main-bold;">v</span></span></span><span class="mo" id="MathJax-Span-395" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(2.464em, 1006.6em, 4.833em, -999.998em); top: -3.203em; right: 0em;"><span class="mtd" id="MathJax-Span-401"><span class="mrow" id="MathJax-Span-402"><span class="mi" id="MathJax-Span-403" style="font-family: MathJax_Math-italic;">ρ</span><span class="mfrac" id="MathJax-Span-404"><span style="display: inline-block; position: relative; width: 1.303em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1001.16em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.602em;"><span class="mrow" id="MathJax-Span-405"><span class="mi" id="MathJax-Span-406" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="texatom" id="MathJax-Span-407"><span class="mrow" id="MathJax-Span-408"><span class="mi" id="MathJax-Span-409" style="font-family: MathJax_Main-bold;">v</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1000.88em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.462em;"><span class="mrow" id="MathJax-Span-410"><span class="mi" id="MathJax-Span-411" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mi" id="MathJax-Span-412" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1001.3em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.303em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mo" id="MathJax-Span-413" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="mi" id="MathJax-Span-414" style="font-family: MathJax_Math-italic; padding-left: 0.235em;">ρ</span><span class="mi" id="MathJax-Span-415" style="font-family: MathJax_Main;">∇</span><span class="texatom" id="MathJax-Span-416"><span class="mrow" id="MathJax-Span-417"><span class="mi" id="MathJax-Span-418" style="font-family: MathJax_Main-bold;">v</span></span></span><span class="mo" id="MathJax-Span-419" style="font-family: MathJax_Main; padding-left: 0.235em;">⋅</span><span class="texatom" id="MathJax-Span-420" style="padding-left: 0.235em;"><span class="mrow" id="MathJax-Span-421"><span class="mi" id="MathJax-Span-422" style="font-family: MathJax_Main-bold;">v</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.415em;"></span></span><span style="position: absolute; clip: rect(2em, 1001.95em, 4.926em, -999.998em); top: -3.992em; left: 6.598em;"><span style="display: inline-block; position: relative; width: 2em; height: 0px;"><span style="position: absolute; clip: rect(3.207em, 1001.81em, 4.136em, -999.998em); top: -5.154em; left: 0em;"><span class="mtd" id="MathJax-Span-396"><span class="mrow" id="MathJax-Span-397"><span class="mi" id="MathJax-Span-398"></span><span class="mo" id="MathJax-Span-399" style="font-family: MathJax_Main; padding-left: 0.281em;">=</span><span class="mn" id="MathJax-Span-400" style="font-family: MathJax_Main; padding-left: 0.281em;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1001.95em, 4.136em, -999.998em); top: -3.203em; left: 0em;"><span class="mtd" id="MathJax-Span-423"><span class="mrow" id="MathJax-Span-424"><span class="mi" id="MathJax-Span-425"></span><span class="mo" id="MathJax-Span-426" style="font-family: MathJax_Main; padding-left: 0.281em;">=</span><span class="texatom" id="MathJax-Span-427" style="padding-left: 0.281em;"><span class="mrow" id="MathJax-Span-428"><span class="mi" id="MathJax-Span-429" style="font-family: MathJax_Main-bold;">b</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.791em; border-left: 0px solid; width: 0px; height: 4.133em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mover><mi>ρ</mi><mo>˙</mo></mover></mrow><mo>+</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><mo stretchy="false">(</mo><mi>ρ</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><mn>0</mn></mtd></mtr><mtr><mtd><mi>ρ</mi><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mi>ρ</mi><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mo>⋅</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow></mtd><mtd><mi></mi><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">b</mi></mrow></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-20">\begin{align*}
\dot{\rho} +\nabla\cdot (\rho {\bf v}) &= 0 \\
\rho\p{\vv}{t} + \rho\nabla \vv \cdot \vv &= {\bf b}
\end{align*}</script></p>
<p>While the central quantities of these equations, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C1;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-430" style="width: 0.606em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.628em, 1000.51em, 2.604em, -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-431"><span class="mi" id="MathJax-Span-432" style="font-family: MathJax_Math-italic;">ρ</span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.323em; border-left: 0px solid; width: 0px; height: 0.872em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ρ</mi></math></span></span><script type="math/tex" id="MathJax-Element-21">\rho</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-433" style="width: 0.746em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.606em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.675em, 1000.56em, 2.418em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-434"><span class="mi" id="MathJax-Span-435" style="font-family: MathJax_Main-bold;">v</span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.655em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold">v</mi></math></span></span><script type="math/tex" id="MathJax-Element-22">\bf v</script>, are easy to reason about intuitively, the forces acting on the fluid (represented by <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-436" style="width: 0.792em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.442em, 1000.61em, 2.418em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-437"><span class="mi" id="MathJax-Span-438" style="font-family: MathJax_Main-bold;">b</span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold">b</mi></math></span></span><script type="math/tex" id="MathJax-Element-23">\bf b</script>) are not so clear. Traditionally, the next step is an assumption about the set of body forces <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-439" style="width: 0.792em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.442em, 1000.61em, 2.418em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-440"><span class="mi" id="MathJax-Span-441" style="font-family: MathJax_Main-bold;">b</span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold">b</mi></math></span></span><script type="math/tex" id="MathJax-Element-24">\bf b</script>, followed by further simplifications; eventually, this reaches a point where the equation can be discretized in a clever manner and simulated. For Newtonian fluids, for instance, we assume that the body forces consist of some external force <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-442" style="width: 0.56em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.442em, 1000.47em, 2.418em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-443"><span class="mi" id="MathJax-Span-444" style="font-family: MathJax_Main-bold;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold">f</mi></math></span></span><script type="math/tex" id="MathJax-Element-25">\bf f</script> and an internal fluid stress due to the pressure of the fluid. The resulting system is effectively a system of nonlinear partial differential equations of second order in seven dimensions (time, three space dimensions, and three velocity dimensions); simulating these accurately and efficiently is possible but quite difficult, and often causes numerical difficulties in addition to computational efficiency concerns. (For instance, naive implementations of incompressible fluid flow will introduce numerical errors that are indistinguishable from an extra viscosity term, even if it is assumed that the flow is entirely inviscid.)</p>
<p>Instead of delving into further details, we turn to the Boltzmann equation for a different approach.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Boltzmann-Transport-Equation">Boltzmann Transport Equation<a class="anchor-link" href="http://andrew.gibiansky.com/blog/physics/lattice-boltzmann-method/#Boltzmann-Transport-Equation"></a></h2><p>In this section, we provide a movitational sketch of a derivation for the Boltzmann transport equation. Note that we thoroughly ignore many physical aspects, focusing solely on the mathematics and nature of the differential equation. Developing physically accurate simulations would require a greater degree of attention to units and scaling constants, all of which we ignore.</p>
<p>The fundamental assumption behind the Boltzmann equation is that we can describe a system as a probability distribution over particles. Each particle has a probability density <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-445" style="width: 4.462em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.811em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.396em, 1003.72em, 2.65em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-446"><span class="mi" id="MathJax-Span-447" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mo" id="MathJax-Span-448" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-449"><span class="mrow" id="MathJax-Span-450"><span class="mi" id="MathJax-Span-451" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-452" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-453" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-454"><span class="mi" id="MathJax-Span-455" style="font-family: MathJax_Main-bold;">v</span></span></span><span class="mo" id="MathJax-Span-456" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-457" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">t</span><span class="mo" id="MathJax-Span-458" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.323em; border-left: 0px solid; width: 0px; height: 1.307em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mo>,</mo><mi>t</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-26">f({\bf x}, {\bf v}, t)</script> associated with it, which represents the probability that the particle is at position <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-459" style="width: 0.746em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.606em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.675em, 1000.61em, 2.418em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-460"><span class="mi" id="MathJax-Span-461" style="font-family: MathJax_Main-bold;">x</span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.655em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold">x</mi></math></span></span><script type="math/tex" id="MathJax-Element-27">\bf x</script> with velocity <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-462" style="width: 0.746em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.606em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.675em, 1000.56em, 2.418em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-463"><span class="mi" id="MathJax-Span-464" style="font-family: MathJax_Main-bold;">v</span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.655em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold">v</mi></math></span></span><script type="math/tex" id="MathJax-Element-28">\bf v</script> at time <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-465" style="width: 0.467em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.374em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.489em, 1000.33em, 2.371em, -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-466"><span class="mi" id="MathJax-Span-467" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.872em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-29">t</script>. From this assumption, we can derive a collision-less variant of the Boltzmann transport equation.</p>
<p>Consider a particle of mass <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-468" style="width: 1.071em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.628em, 1000.88em, 2.371em, -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-469"><span class="mi" id="MathJax-Span-470" style="font-family: MathJax_Math-italic;">m</span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.655em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-30">m</script> at position <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-471" style="width: 0.746em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.606em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.675em, 1000.61em, 2.418em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-472"><span class="mi" id="MathJax-Span-473" style="font-family: MathJax_Main-bold;">x</span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.655em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold">x</mi></math></span></span><script type="math/tex" id="MathJax-Element-31">\bf x</script> at time <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-474" style="width: 0.467em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.374em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.489em, 1000.33em, 2.371em, -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-475"><span class="mi" id="MathJax-Span-476" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.872em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-32">t</script> with velocity  <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-477" style="width: 0.746em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.606em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.675em, 1000.56em, 2.418em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-478"><span class="mi" id="MathJax-Span-479" style="font-family: MathJax_Main-bold;">v</span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.655em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold">v</mi></math></span></span><script type="math/tex" id="MathJax-Element-33">\bf v</script>. Assume also that some force <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;F&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-480" style="width: 0.885em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.746em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.442em, 1000.7em, 2.418em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-481"><span class="mi" id="MathJax-Span-482" style="font-family: MathJax_Main-bold;">F</span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold">F</mi></math></span></span><script type="math/tex" id="MathJax-Element-34">\bf F</script> acts upon this particle. What, then, happens to this particle at time <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-483" style="width: 3.254em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.789em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.442em, 1002.74em, 2.511em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-484"><span class="mi" id="MathJax-Span-485" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-486" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="mi" id="MathJax-Span-487" style="font-family: MathJax_Main; padding-left: 0.235em;">Δ</span><span class="mi" id="MathJax-Span-488" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.16em; border-left: 0px solid; width: 0px; height: 1.035em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-35">t + \Delta t</script>? From basic Newtonian physics, we know that the particle will retain its mass <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-489" style="width: 1.071em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.628em, 1000.88em, 2.371em, -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-490"><span class="mi" id="MathJax-Span-491" style="font-family: MathJax_Math-italic;">m</span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.655em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-36">m</script>, but be at position <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-492" style="width: 4.322em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.672em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.442em, 1003.63em, 2.511em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-493"><span class="texatom" id="MathJax-Span-494"><span class="mrow" id="MathJax-Span-495"><span class="mi" id="MathJax-Span-496" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-497" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="mi" id="MathJax-Span-498" style="font-family: MathJax_Main; padding-left: 0.235em;">Δ</span><span class="mi" id="MathJax-Span-499" style="font-family: MathJax_Math-italic;">t</span><span class="texatom" id="MathJax-Span-500"><span class="mrow" id="MathJax-Span-501"><span class="mi" id="MathJax-Span-502" style="font-family: MathJax_Main-bold;">v</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.16em; border-left: 0px solid; width: 0px; height: 1.035em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-37">{\bf x} + \Delta t{\bf v}</script> and have velocity <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mfrac&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;F&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-503" style="width: 4.787em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.09em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.257em, 1004.09em, 2.789em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-504"><span class="texatom" id="MathJax-Span-505"><span class="mrow" id="MathJax-Span-506"><span class="mi" id="MathJax-Span-507" style="font-family: MathJax_Main-bold;">v</span></span></span><span class="mo" id="MathJax-Span-508" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="mi" id="MathJax-Span-509" style="font-family: MathJax_Main; padding-left: 0.235em;">Δ</span><span class="mi" id="MathJax-Span-510" style="font-family: MathJax_Math-italic;">t</span><span class="mfrac" id="MathJax-Span-511"><span style="display: inline-block; position: relative; width: 0.746em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.393em, 1000.47em, 4.136em, -999.998em); top: -4.411em; left: 50%; margin-left: -0.276em;"><span class="mi" id="MathJax-Span-512" style="font-size: 70.7%; font-family: MathJax_Main-bold;">F</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.533em, 1000.61em, 4.136em, -999.998em); top: -3.667em; left: 50%; margin-left: -0.323em;"><span class="mi" id="MathJax-Span-513" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1000.75em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.746em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.486em; border-left: 0px solid; width: 0px; height: 1.524em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>t</mi><mfrac><mi mathvariant="bold">F</mi><mi>m</mi></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-38">{\bf v} + \Delta t\frac{\bf F}{m}</script>. We can extend this reasoning to our probability density function and an infinitesimal time increment, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-514" style="width: 3.951em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.347em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.442em, 1003.3em, 2.418em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-515"><span class="mi" id="MathJax-Span-516" style="font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-517" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-518" style="font-family: MathJax_Main; padding-left: 0.281em;">=</span><span class="mi" id="MathJax-Span-519" style="font-family: MathJax_Math-italic; padding-left: 0.281em;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-520" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.981em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Δ</mi><mi>t</mi><mo>=</mo><mi>δ</mi><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-39">\Delta t = \delta t</script>:
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;F&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/mfrac&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-521" style="width: 20.952em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.886em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.86em, 1017.65em, 4.508em, -999.998em); top: -3.435em; left: 0em;"><span class="mrow" id="MathJax-Span-522"><span class="mi" id="MathJax-Span-523" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mo" id="MathJax-Span-524" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-525"><span class="mrow" id="MathJax-Span-526"><span class="mi" id="MathJax-Span-527" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-528" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-529" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-530"><span class="mi" id="MathJax-Span-531" style="font-family: MathJax_Main-bold;">v</span></span></span><span class="mo" id="MathJax-Span-532" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-533" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">t</span><span class="mo" id="MathJax-Span-534" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-535" style="font-family: MathJax_Main; padding-left: 0.281em;">=</span><span class="mi" id="MathJax-Span-536" style="font-family: MathJax_Math-italic; padding-left: 0.281em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mrow" id="MathJax-Span-537" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-538" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span><span class="mrow" id="MathJax-Span-539"><span class="texatom" id="MathJax-Span-540"><span class="mrow" id="MathJax-Span-541"><span class="mi" id="MathJax-Span-542" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-543" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="texatom" id="MathJax-Span-544" style="padding-left: 0.235em;"><span class="mrow" id="MathJax-Span-545"><span class="mi" id="MathJax-Span-546" style="font-family: MathJax_Main-bold;">v</span></span></span><span class="mi" id="MathJax-Span-547" style="font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-548" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-549" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-550" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-551"><span class="mi" id="MathJax-Span-552" style="font-family: MathJax_Main-bold;">v</span></span></span><span class="mo" id="MathJax-Span-553" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="mfrac" id="MathJax-Span-554" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1000.7em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.369em;"><span class="mi" id="MathJax-Span-555" style="font-family: MathJax_Main-bold;">F</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em, 1000.84em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.416em;"><span class="mi" id="MathJax-Span-556" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1000.98em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.978em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mi" id="MathJax-Span-557" style="font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-558" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-559" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-560" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">t</span><span class="mo" id="MathJax-Span-561" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="mi" id="MathJax-Span-562" style="font-family: MathJax_Math-italic; padding-left: 0.235em;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-563" style="font-family: MathJax_Math-italic;">t</span></span><span class="mo" id="MathJax-Span-564" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.44em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.139em; border-left: 0px solid; width: 0px; height: 2.938em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>f</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mo>,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mrow><mo>(</mo><mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mi>δ</mi><mi>t</mi><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mo>+</mo><mfrac><mi mathvariant="bold">F</mi><mi>m</mi></mfrac><mi>δ</mi><mi>t</mi><mo>,</mo><mi>t</mi><mo>+</mo><mi>δ</mi><mi>t</mi></mrow><mo>)</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-40">f({\bf x}, {\bf v}, t) = f\left({\bf x} + {\bf v}\delta t, {\bf v} + \frac{\bf F}{m}\delta t, t + \delta t\right)</script></p>
<p>We can use this to take the derivative, yielding</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;munder&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;lim&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;F&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/mfrac&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0.&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-565" style="width: 28.57em; display: inline-block;"><span style="display: inline-block; position: relative; width: 24.389em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.86em, 1024.3em, 4.508em, -999.998em); top: -3.435em; left: 0em;"><span class="mrow" id="MathJax-Span-566"><span class="munderover" id="MathJax-Span-567"><span style="display: inline-block; position: relative; width: 1.628em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1001.4em, 4.136em, -999.998em); top: -3.992em; left: 0.142em;"><span class="mo" id="MathJax-Span-568" style="font-family: MathJax_Main;">lim</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.347em, 1001.63em, 4.229em, -999.998em); top: -3.296em; left: 0em;"><span class="texatom" id="MathJax-Span-569"><span class="mrow" id="MathJax-Span-570"><span class="mi" id="MathJax-Span-571" style="font-size: 70.7%; font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-572" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-573" style="font-size: 70.7%; font-family: MathJax_Main;">→</span><span class="mn" id="MathJax-Span-574" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-575" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.207em, 1000.42em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.23em;"><span class="mn" id="MathJax-Span-576" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1000.79em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.416em;"><span class="mrow" id="MathJax-Span-577"><span class="mi" id="MathJax-Span-578" style="font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-579" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1000.93em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.931em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mrow" id="MathJax-Span-580"><span class="mo" id="MathJax-Span-581" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span><span class="mrow" id="MathJax-Span-582"><span class="mi" id="MathJax-Span-583" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mrow" id="MathJax-Span-584" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-585" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span><span class="mrow" id="MathJax-Span-586"><span class="texatom" id="MathJax-Span-587"><span class="mrow" id="MathJax-Span-588"><span class="mi" id="MathJax-Span-589" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-590" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="texatom" id="MathJax-Span-591" style="padding-left: 0.235em;"><span class="mrow" id="MathJax-Span-592"><span class="mi" id="MathJax-Span-593" style="font-family: MathJax_Main-bold;">v</span></span></span><span class="mi" id="MathJax-Span-594" style="font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-595" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-596" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-597" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-598"><span class="mi" id="MathJax-Span-599" style="font-family: MathJax_Main-bold;">v</span></span></span><span class="mo" id="MathJax-Span-600" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="mfrac" id="MathJax-Span-601" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1000.7em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.369em;"><span class="mi" id="MathJax-Span-602" style="font-family: MathJax_Main-bold;">F</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em, 1000.84em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.416em;"><span class="mi" id="MathJax-Span-603" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1000.98em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.978em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mi" id="MathJax-Span-604" style="font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-605" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-606" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-607" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">t</span><span class="mo" id="MathJax-Span-608" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="mi" id="MathJax-Span-609" style="font-family: MathJax_Math-italic; padding-left: 0.235em;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-610" style="font-family: MathJax_Math-italic;">t</span></span><span class="mo" id="MathJax-Span-611" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span><span class="mo" id="MathJax-Span-612" style="font-family: MathJax_Main; padding-left: 0.235em;">−</span><span class="mi" id="MathJax-Span-613" style="font-family: MathJax_Math-italic; padding-left: 0.235em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mo" id="MathJax-Span-614" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-615"><span class="mrow" id="MathJax-Span-616"><span class="mi" id="MathJax-Span-617" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-618" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-619" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-620"><span class="mi" id="MathJax-Span-621" style="font-family: MathJax_Main-bold;">v</span></span></span><span class="mo" id="MathJax-Span-622" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-623" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">t</span><span class="mo" id="MathJax-Span-624" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-625" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span><span class="mo" id="MathJax-Span-626" style="font-family: MathJax_Main; padding-left: 0.281em;">=</span><span class="mn" id="MathJax-Span-627" style="font-family: MathJax_Main; padding-left: 0.281em;">0.</span></span><span style="display: inline-block; width: 0px; height: 3.44em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.139em; border-left: 0px solid; width: 0px; height: 2.938em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><munder><mo movablelimits="true" form="prefix">lim</mo><mrow class="MJX-TeXAtom-ORD"><mi>δ</mi><mi>t</mi><mo stretchy="false">→</mo><mn>0</mn></mrow></munder><mfrac><mn>1</mn><mrow><mi>δ</mi><mi>t</mi></mrow></mfrac><mrow><mo>(</mo><mrow><mi>f</mi><mrow><mo>(</mo><mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mi>δ</mi><mi>t</mi><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mo>+</mo><mfrac><mi mathvariant="bold">F</mi><mi>m</mi></mfrac><mi>δ</mi><mi>t</mi><mo>,</mo><mi>t</mi><mo>+</mo><mi>δ</mi><mi>t</mi></mrow><mo>)</mo></mrow><mo>−</mo><mi>f</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mo>,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><mo>)</mo></mrow><mo>=</mo><mn>0.</mn></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-41">\lim_{\delta t \to 0} \frac{1}{\delta t}\left( f\left({\bf x} + {\bf v}\delta t, {\bf v} + \frac{\bf F}{m}\delta t, t + \delta t\right) -f({\bf x}, {\bf v}, t) \right) = 0.</script></p>
<p>We can obtain the same result via the chain rule, if we express <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-628" style="width: 0.746em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.606em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.675em, 1000.61em, 2.418em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-629"><span class="mi" id="MathJax-Span-630" style="font-family: MathJax_Main-bold;">x</span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.655em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold">x</mi></math></span></span><script type="math/tex" id="MathJax-Element-42">\bf x</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-631" style="width: 0.746em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.606em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.675em, 1000.56em, 2.418em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-632"><span class="mi" id="MathJax-Span-633" style="font-family: MathJax_Main-bold;">v</span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.655em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold">v</mi></math></span></span><script type="math/tex" id="MathJax-Element-43">\bf v</script> as functions of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-634" style="width: 0.467em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.374em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.489em, 1000.33em, 2.371em, -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-635"><span class="mi" id="MathJax-Span-636" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.872em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-44">t</script>. Evaluating this limit yields the equation</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;F&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0.&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-637" style="width: 29.313em; display: inline-block;"><span style="display: inline-block; position: relative; width: 25.039em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(-2.552em, 1024.85em, 6.505em, -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-638"><span class="mtable" id="MathJax-Span-639" style="padding-right: 0.188em; padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 24.668em; height: 0px;"><span style="position: absolute; clip: rect(4.833em, 1010.13em, 13.705em, -999.998em); top: -9.613em; left: 0em;"><span style="display: inline-block; position: relative; width: 10.129em; height: 0px;"><span style="position: absolute; clip: rect(2.464em, 1010.13em, 4.833em, -999.998em); top: -7.244em; right: 0em;"><span class="mtd" id="MathJax-Span-640"><span class="mrow" id="MathJax-Span-641"><span class="mfrac" id="MathJax-Span-642"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1001.12em, 4.322em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.555em;"><span class="mrow" id="MathJax-Span-643"><span class="mi" id="MathJax-Span-644" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mi" id="MathJax-Span-645" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1000.88em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.462em;"><span class="mrow" id="MathJax-Span-646"><span class="mi" id="MathJax-Span-647" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mi" id="MathJax-Span-648" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1001.26em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.257em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mo" id="MathJax-Span-649" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="mfrac" id="MathJax-Span-650" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.303em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1001.12em, 4.322em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.555em;"><span class="mrow" id="MathJax-Span-651"><span class="mi" id="MathJax-Span-652" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mi" id="MathJax-Span-653" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1001.16em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.602em;"><span class="mrow" id="MathJax-Span-654"><span class="mi" id="MathJax-Span-655" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="texatom" id="MathJax-Span-656"><span class="mrow" id="MathJax-Span-657"><span class="mi" id="MathJax-Span-658" style="font-family: MathJax_Main-bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1001.3em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.303em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-659"><span style="display: inline-block; position: relative; width: 1.303em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1001.16em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.602em;"><span class="mrow" id="MathJax-Span-660"><span class="mi" id="MathJax-Span-661" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="texatom" id="MathJax-Span-662"><span class="mrow" id="MathJax-Span-663"><span class="mi" id="MathJax-Span-664" style="font-family: MathJax_Main-bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1000.88em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.462em;"><span class="mrow" id="MathJax-Span-665"><span class="mi" id="MathJax-Span-666" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mi" id="MathJax-Span-667" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1001.3em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.303em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mo" id="MathJax-Span-668" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="mfrac" id="MathJax-Span-669" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.303em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1001.12em, 4.322em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.555em;"><span class="mrow" id="MathJax-Span-670"><span class="mi" id="MathJax-Span-671" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mi" id="MathJax-Span-672" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1001.16em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.602em;"><span class="mrow" id="MathJax-Span-673"><span class="mi" id="MathJax-Span-674" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="texatom" id="MathJax-Span-675"><span class="mrow" id="MathJax-Span-676"><span class="mi" id="MathJax-Span-677" style="font-family: MathJax_Main-bold;">v</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1001.3em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.303em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-678"><span style="display: inline-block; position: relative; width: 1.303em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1001.16em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.602em;"><span class="mrow" id="MathJax-Span-679"><span class="mi" id="MathJax-Span-680" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="texatom" id="MathJax-Span-681"><span class="mrow" id="MathJax-Span-682"><span class="mi" id="MathJax-Span-683" style="font-family: MathJax_Main-bold;">v</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1000.88em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.462em;"><span class="mrow" id="MathJax-Span-684"><span class="mi" id="MathJax-Span-685" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mi" id="MathJax-Span-686" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1001.3em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.303em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.858em, 1000em, 4.136em, -999.998em); top: -4.782em; right: 0em;"><span class="mtd" id="MathJax-Span-731"><span class="mrow" id="MathJax-Span-732"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.858em, 1000em, 4.136em, -999.998em); top: -2.088em; right: 0em;"><span class="mtd" id="MathJax-Span-779"><span class="mrow" id="MathJax-Span-780"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.858em, 1000em, 4.136em, -999.998em); top: -0.044em; right: 0em;"><span class="mtd" id="MathJax-Span-815"><span class="mrow" id="MathJax-Span-816"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 9.618em;"></span></span><span style="position: absolute; clip: rect(4.833em, 1014.59em, 13.705em, -999.998em); top: -9.613em; left: 10.129em;"><span style="display: inline-block; position: relative; width: 14.588em; height: 0px;"><span style="position: absolute; clip: rect(2.464em, 1014.03em, 4.833em, -999.998em); top: -7.244em; left: 0em;"><span class="mtd" id="MathJax-Span-687"><span class="mrow" id="MathJax-Span-688"><span class="mi" id="MathJax-Span-689"></span><span class="mo" id="MathJax-Span-690" style="font-family: MathJax_Main; padding-left: 0.281em;">=</span><span class="mfrac" id="MathJax-Span-691" style="padding-left: 0.281em;"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1000.56em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.276em;"><span class="mi" id="MathJax-Span-692" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1000.88em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.462em;"><span class="mrow" id="MathJax-Span-693"><span class="mi" id="MathJax-Span-694" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mi" id="MathJax-Span-695" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1001.07em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.071em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mi" id="MathJax-Span-696" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mo" id="MathJax-Span-697" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="mfrac" id="MathJax-Span-698" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.303em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1001.16em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.602em;"><span class="mrow" id="MathJax-Span-699"><span class="mi" id="MathJax-Span-700" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="texatom" id="MathJax-Span-701"><span class="mrow" id="MathJax-Span-702"><span class="mi" id="MathJax-Span-703" style="font-family: MathJax_Main-bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1000.88em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.462em;"><span class="mrow" id="MathJax-Span-704"><span class="mi" id="MathJax-Span-705" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mi" id="MathJax-Span-706" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1001.3em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.303em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mo" id="MathJax-Span-707" style="font-family: MathJax_Main; padding-left: 0.235em;">⋅</span><span class="msubsup" id="MathJax-Span-708" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.349em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.79em, 4.183em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-709" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.838em;"><span class="texatom" id="MathJax-Span-710"><span class="mrow" id="MathJax-Span-711"><span class="mi" id="MathJax-Span-712" style="font-size: 70.7%; font-family: MathJax_Main-bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mi" id="MathJax-Span-713" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mo" id="MathJax-Span-714" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="mfrac" id="MathJax-Span-715" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.303em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1001.16em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.602em;"><span class="mrow" id="MathJax-Span-716"><span class="mi" id="MathJax-Span-717" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="texatom" id="MathJax-Span-718"><span class="mrow" id="MathJax-Span-719"><span class="mi" id="MathJax-Span-720" style="font-family: MathJax_Main-bold;">v</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1000.88em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.462em;"><span class="mrow" id="MathJax-Span-721"><span class="mi" id="MathJax-Span-722" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mi" id="MathJax-Span-723" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1001.3em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.303em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mo" id="MathJax-Span-724" style="font-family: MathJax_Main; padding-left: 0.235em;">⋅</span><span class="msubsup" id="MathJax-Span-725" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.349em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.79em, 4.183em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-726" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.838em;"><span class="texatom" id="MathJax-Span-727"><span class="mrow" id="MathJax-Span-728"><span class="mi" id="MathJax-Span-729" style="font-size: 70.7%; font-family: MathJax_Main-bold;">v</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mi" id="MathJax-Span-730" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(2.418em, 1014.59em, 5.065em, -999.998em); top: -4.782em; left: 0em;"><span class="mtd" id="MathJax-Span-733"><span class="mrow" id="MathJax-Span-734"><span class="mi" id="MathJax-Span-735"></span><span class="mo" id="MathJax-Span-736" style="font-family: MathJax_Main; padding-left: 0.281em;">=</span><span class="mrow" id="MathJax-Span-737" style="padding-left: 0.281em;"><span class="mo" id="MathJax-Span-738" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span><span class="mrow" id="MathJax-Span-739"><span class="mfrac" id="MathJax-Span-740"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1000.56em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.276em;"><span class="mi" id="MathJax-Span-741" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1000.88em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.462em;"><span class="mrow" id="MathJax-Span-742"><span class="mi" id="MathJax-Span-743" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mi" id="MathJax-Span-744" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1001.07em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.071em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mo" id="MathJax-Span-745" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="mfrac" id="MathJax-Span-746" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.303em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1001.16em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.602em;"><span class="mrow" id="MathJax-Span-747"><span class="mi" id="MathJax-Span-748" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="texatom" id="MathJax-Span-749"><span class="mrow" id="MathJax-Span-750"><span class="mi" id="MathJax-Span-751" style="font-family: MathJax_Main-bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1000.88em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.462em;"><span class="mrow" id="MathJax-Span-752"><span class="mi" id="MathJax-Span-753" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mi" id="MathJax-Span-754" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1001.3em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.303em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mo" id="MathJax-Span-755" style="font-family: MathJax_Main; padding-left: 0.235em;">⋅</span><span class="msubsup" id="MathJax-Span-756" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.349em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.79em, 4.183em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-757" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.838em;"><span class="texatom" id="MathJax-Span-758"><span class="mrow" id="MathJax-Span-759"><span class="mi" id="MathJax-Span-760" style="font-size: 70.7%; font-family: MathJax_Main-bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-761" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="mfrac" id="MathJax-Span-762" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.303em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1001.16em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.602em;"><span class="mrow" id="MathJax-Span-763"><span class="mi" id="MathJax-Span-764" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="texatom" id="MathJax-Span-765"><span class="mrow" id="MathJax-Span-766"><span class="mi" id="MathJax-Span-767" style="font-family: MathJax_Main-bold;">v</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1000.88em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.462em;"><span class="mrow" id="MathJax-Span-768"><span class="mi" id="MathJax-Span-769" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mi" id="MathJax-Span-770" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1001.3em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.303em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mo" id="MathJax-Span-771" style="font-family: MathJax_Main; padding-left: 0.235em;">⋅</span><span class="msubsup" id="MathJax-Span-772" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.349em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.79em, 4.183em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-773" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.838em;"><span class="texatom" id="MathJax-Span-774"><span class="mrow" id="MathJax-Span-775"><span class="mi" id="MathJax-Span-776" style="font-size: 70.7%; font-family: MathJax_Main-bold;">v</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-777" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span><span class="mi" id="MathJax-Span-778" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(2.418em, 1013.33em, 5.065em, -999.998em); top: -2.088em; left: 0em;"><span class="mtd" id="MathJax-Span-781"><span class="mrow" id="MathJax-Span-782"><span class="mi" id="MathJax-Span-783"></span><span class="mo" id="MathJax-Span-784" style="font-family: MathJax_Main; padding-left: 0.281em;">=</span><span class="mrow" id="MathJax-Span-785" style="padding-left: 0.281em;"><span class="mo" id="MathJax-Span-786" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span><span class="mrow" id="MathJax-Span-787"><span class="mfrac" id="MathJax-Span-788"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1000.56em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.276em;"><span class="mi" id="MathJax-Span-789" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1000.88em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.462em;"><span class="mrow" id="MathJax-Span-790"><span class="mi" id="MathJax-Span-791" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mi" id="MathJax-Span-792" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1001.07em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.071em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mo" id="MathJax-Span-793" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="texatom" id="MathJax-Span-794" style="padding-left: 0.235em;"><span class="mrow" id="MathJax-Span-795"><span class="mi" id="MathJax-Span-796" style="font-family: MathJax_Main-bold;">v</span></span></span><span class="mo" id="MathJax-Span-797" style="font-family: MathJax_Main; padding-left: 0.235em;">⋅</span><span class="msubsup" id="MathJax-Span-798" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.349em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.79em, 4.183em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-799" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.838em;"><span class="texatom" id="MathJax-Span-800"><span class="mrow" id="MathJax-Span-801"><span class="mi" id="MathJax-Span-802" style="font-size: 70.7%; font-family: MathJax_Main-bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-803" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="mfrac" id="MathJax-Span-804" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1000.7em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.369em;"><span class="mi" id="MathJax-Span-805" style="font-family: MathJax_Main-bold;">F</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em, 1000.84em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.416em;"><span class="mi" id="MathJax-Span-806" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1000.98em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.978em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mo" id="MathJax-Span-807" style="font-family: MathJax_Main; padding-left: 0.235em;">⋅</span><span class="msubsup" id="MathJax-Span-808" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.349em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.79em, 4.183em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-809" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.838em;"><span class="texatom" id="MathJax-Span-810"><span class="mrow" id="MathJax-Span-811"><span class="mi" id="MathJax-Span-812" style="font-size: 70.7%; font-family: MathJax_Main-bold;">v</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-813" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span><span class="mi" id="MathJax-Span-814" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.207em, 1002.05em, 4.136em, -999.998em); top: -0.044em; left: 0em;"><span class="mtd" id="MathJax-Span-817"><span class="mrow" id="MathJax-Span-818"><span class="mi" id="MathJax-Span-819"></span><span class="mo" id="MathJax-Span-820" style="font-family: MathJax_Main; padding-left: 0.281em;">=</span><span class="mn" id="MathJax-Span-821" style="font-family: MathJax_Main; padding-left: 0.281em;">0.</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 9.618em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -4.889em; border-left: 0px solid; width: 0px; height: 10.383em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac></mtd><mtd><mi></mi><mo>=</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mi>f</mi><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>⋅</mo><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></msub><mi>f</mi><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>⋅</mo><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow></msub><mi>f</mi></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><mrow><mo>(</mo><mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>⋅</mo><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></msub><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>⋅</mo><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow></msub></mrow><mo>)</mo></mrow><mi>f</mi></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><mrow><mo>(</mo><mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mo>⋅</mo><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></msub><mo>+</mo><mfrac><mi mathvariant="bold">F</mi><mi>m</mi></mfrac><mo>⋅</mo><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow></msub></mrow><mo>)</mo></mrow><mi>f</mi></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><mn>0.</mn></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-45">\newcommand\xx{{\bf x}}
\begin{align*}
\p{f}{t} + \p{f}{\xx}\p{\xx}{t}  + \p{f}{\vv}\p{\vv}{t}
&= \p{}{t}f + \p{\xx}{t}\cdot \nabla_\xx f + \p{\vv}{t}\cdot \nabla_\vv f \\
&= \left(\p{}{t} + \p{\xx}{t}\cdot \nabla_\xx+ \p{\vv}{t}\cdot \nabla_\vv\right)f \\
&= \left(\p{}{t} + \vv\cdot \nabla_\xx+ \frac{\bf F}{m}\cdot \nabla_\vv\right)f
\\&= 0.
\end{align*}</script></p>
<p>It is important to note that in our notation, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-822" style="width: 1.582em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.349em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.396em, 1001.35em, 2.511em, -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-823"><span class="msubsup" id="MathJax-Span-824"><span style="display: inline-block; position: relative; width: 1.349em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.79em, 4.183em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-825" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.838em;"><span class="texatom" id="MathJax-Span-826"><span class="mrow" id="MathJax-Span-827"><span class="mi" id="MathJax-Span-828" style="font-size: 70.7%; font-family: MathJax_Main-bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.215em; border-left: 0px solid; width: 0px; height: 1.09em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-46">\nabla_\xx</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-829" style="width: 1.582em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.349em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.396em, 1001.35em, 2.511em, -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-830"><span class="msubsup" id="MathJax-Span-831"><span style="display: inline-block; position: relative; width: 1.349em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.79em, 4.183em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-832" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.838em;"><span class="texatom" id="MathJax-Span-833"><span class="mrow" id="MathJax-Span-834"><span class="mi" id="MathJax-Span-835" style="font-size: 70.7%; font-family: MathJax_Main-bold;">v</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.215em; border-left: 0px solid; width: 0px; height: 1.09em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-47">\nabla_\vv</script> are not directional derivatives, buth rather simply shorthands for the gradient in the position and velocity spaces. Thus, we get our final collision-less Boltzmann transport equation:
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;F&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0.&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-836" style="width: 16.632em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.216em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.86em, 1014.12em, 4.508em, -999.998em); top: -3.435em; left: 0em;"><span class="mrow" id="MathJax-Span-837"><span class="mrow" id="MathJax-Span-838"><span class="mo" id="MathJax-Span-839" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span><span class="mrow" id="MathJax-Span-840"><span class="mfrac" id="MathJax-Span-841"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1000.56em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.276em;"><span class="mi" id="MathJax-Span-842" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1000.88em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.462em;"><span class="mrow" id="MathJax-Span-843"><span class="mi" id="MathJax-Span-844" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mi" id="MathJax-Span-845" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1001.07em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.071em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mo" id="MathJax-Span-846" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="texatom" id="MathJax-Span-847" style="padding-left: 0.235em;"><span class="mrow" id="MathJax-Span-848"><span class="mi" id="MathJax-Span-849" style="font-family: MathJax_Main-bold;">v</span></span></span><span class="mo" id="MathJax-Span-850" style="font-family: MathJax_Main; padding-left: 0.235em;">⋅</span><span class="msubsup" id="MathJax-Span-851" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.349em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.79em, 4.183em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-852" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.838em;"><span class="texatom" id="MathJax-Span-853"><span class="mrow" id="MathJax-Span-854"><span class="mi" id="MathJax-Span-855" style="font-size: 70.7%; font-family: MathJax_Main-bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-856" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="mfrac" id="MathJax-Span-857" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1000.7em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.369em;"><span class="mi" id="MathJax-Span-858" style="font-family: MathJax_Main-bold;">F</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em, 1000.84em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.416em;"><span class="mi" id="MathJax-Span-859" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1000.98em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.978em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mo" id="MathJax-Span-860" style="font-family: MathJax_Main; padding-left: 0.235em;">⋅</span><span class="msubsup" id="MathJax-Span-861" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.349em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.79em, 4.183em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-862" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.838em;"><span class="texatom" id="MathJax-Span-863"><span class="mrow" id="MathJax-Span-864"><span class="mi" id="MathJax-Span-865" style="font-size: 70.7%; font-family: MathJax_Main-bold;">v</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-866" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span><span class="mi" id="MathJax-Span-867" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mo" id="MathJax-Span-868" style="font-family: MathJax_Main; padding-left: 0.281em;">=</span><span class="mn" id="MathJax-Span-869" style="font-family: MathJax_Main; padding-left: 0.281em;">0.</span></span><span style="display: inline-block; width: 0px; height: 3.44em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.139em; border-left: 0px solid; width: 0px; height: 2.938em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>(</mo><mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mo>⋅</mo><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></msub><mo>+</mo><mfrac><mi mathvariant="bold">F</mi><mi>m</mi></mfrac><mo>⋅</mo><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow></msub></mrow><mo>)</mo></mrow><mi>f</mi><mo>=</mo><mn>0.</mn></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-48">\left(\p{}{t} + \vv\cdot \nabla_\xx+ \frac{\bf F}{m}\cdot \nabla_\vv\right)f = 0.</script>
To add in collisions, we do what we usually do when we want to add a driving force to a system that evolves as a particular differential equation – we change it from a homogenous to an inhomogenous equation. Thus, we posit that we can describe a Boltzmann equation with collisions using a collision operator <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A9;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-870" style="width: 2.186em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.86em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.396em, 1001.77em, 2.65em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-871"><span class="mi" id="MathJax-Span-872" style="font-family: MathJax_Main;">Ω</span><span class="mo" id="MathJax-Span-873" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-874" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-875" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.323em; border-left: 0px solid; width: 0px; height: 1.307em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Ω</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-49">\Omega(t)</script>, yielding
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;F&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A9;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-876" style="width: 18.211em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.563em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.86em, 1015.47em, 4.508em, -999.998em); top: -3.435em; left: 0em;"><span class="mrow" id="MathJax-Span-877"><span class="mrow" id="MathJax-Span-878"><span class="mo" id="MathJax-Span-879" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span><span class="mrow" id="MathJax-Span-880"><span class="mfrac" id="MathJax-Span-881"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1000.56em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.276em;"><span class="mi" id="MathJax-Span-882" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1000.88em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.462em;"><span class="mrow" id="MathJax-Span-883"><span class="mi" id="MathJax-Span-884" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mi" id="MathJax-Span-885" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1001.07em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.071em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mo" id="MathJax-Span-886" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="texatom" id="MathJax-Span-887" style="padding-left: 0.235em;"><span class="mrow" id="MathJax-Span-888"><span class="mi" id="MathJax-Span-889" style="font-family: MathJax_Main-bold;">v</span></span></span><span class="mo" id="MathJax-Span-890" style="font-family: MathJax_Main; padding-left: 0.235em;">⋅</span><span class="msubsup" id="MathJax-Span-891" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.349em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.79em, 4.183em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-892" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.838em;"><span class="texatom" id="MathJax-Span-893"><span class="mrow" id="MathJax-Span-894"><span class="mi" id="MathJax-Span-895" style="font-size: 70.7%; font-family: MathJax_Main-bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-896" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="mfrac" id="MathJax-Span-897" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1000.7em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.369em;"><span class="mi" id="MathJax-Span-898" style="font-family: MathJax_Main-bold;">F</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em, 1000.84em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.416em;"><span class="mi" id="MathJax-Span-899" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1000.98em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.978em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mo" id="MathJax-Span-900" style="font-family: MathJax_Main; padding-left: 0.235em;">⋅</span><span class="msubsup" id="MathJax-Span-901" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.349em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.79em, 4.183em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-902" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.838em;"><span class="texatom" id="MathJax-Span-903"><span class="mrow" id="MathJax-Span-904"><span class="mi" id="MathJax-Span-905" style="font-size: 70.7%; font-family: MathJax_Main-bold;">v</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-906" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span><span class="mi" id="MathJax-Span-907" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mo" id="MathJax-Span-908" style="font-family: MathJax_Main; padding-left: 0.281em;">=</span><span class="mi" id="MathJax-Span-909" style="font-family: MathJax_Main; padding-left: 0.281em;">Ω</span><span class="mo" id="MathJax-Span-910" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-911" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-912" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-913" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 3.44em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.139em; border-left: 0px solid; width: 0px; height: 2.938em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>(</mo><mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mo>⋅</mo><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></msub><mo>+</mo><mfrac><mi mathvariant="bold">F</mi><mi>m</mi></mfrac><mo>⋅</mo><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow></msub></mrow><mo>)</mo></mrow><mi>f</mi><mo>=</mo><mi mathvariant="normal">Ω</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-50">\left(\p{}{t} + \vv\cdot \nabla_\xx+ \frac{\bf F}{m}\cdot \nabla_\vv\right)f = \Omega(t).</script></p>
<p>Given this equation governing the microscopic dynamics of the system, we can derive macroscopic quantities of interest by integrating over <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-914" style="width: 0.653em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.56em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.396em, 1000.56em, 2.557em, -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-915"><span class="mi" id="MathJax-Span-916" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 1.198em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-51">f</script>:</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mtext&gt;Density:&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mspace width=&quot;2em&quot; /&gt;&lt;mi&gt;&amp;#x03C1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mtext&gt;Momentum:&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mspace width=&quot;2em&quot; /&gt;&lt;mi&gt;&amp;#x03C1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-917" style="width: 24.621em; display: inline-block;"><span style="display: inline-block; position: relative; width: 21.045em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(-0.509em, 1020.81em, 4.508em, -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-918"><span class="mtable" id="MathJax-Span-919" style="padding-right: 0.188em; padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 20.673em; height: 0px;"><span style="position: absolute; clip: rect(2.139em, 1005.25em, 5.623em, -999.998em); top: -4.225em; left: 0em;"><span style="display: inline-block; position: relative; width: 5.298em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1003.53em, 4.322em, -999.998em); top: -5.247em; right: 0em;"><span class="mtd" id="MathJax-Span-920"><span class="mrow" id="MathJax-Span-921"><span class="mtext" id="MathJax-Span-922" style="font-family: MathJax_Main;">Density:</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1005.25em, 4.136em, -999.998em); top: -2.738em; right: 0em;"><span class="mtd" id="MathJax-Span-955"><span class="mrow" id="MathJax-Span-956"><span class="mtext" id="MathJax-Span-957" style="font-family: MathJax_Main;">Momentum:</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.229em;"></span></span><span style="position: absolute; clip: rect(2.371em, 1005.3em, 6.18em, -999.998em); top: -4.503em; left: 5.298em;"><span style="display: inline-block; position: relative; width: 5.344em; height: 0px;"><span style="position: absolute; clip: rect(3.115em, 1004.65em, 4.369em, -999.998em); top: -5.247em; left: 0em;"><span class="mtd" id="MathJax-Span-923"><span class="mrow" id="MathJax-Span-924"><span class="mspace" id="MathJax-Span-925" style="height: 0em; vertical-align: 0em; width: 2em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-926" style="font-family: MathJax_Math-italic;">ρ</span><span class="mo" id="MathJax-Span-927" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-928"><span class="mrow" id="MathJax-Span-929"><span class="mi" id="MathJax-Span-930" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-931" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-932" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">t</span><span class="mo" id="MathJax-Span-933" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.115em, 1005.3em, 4.369em, -999.998em); top: -2.738em; left: 0em;"><span class="mtd" id="MathJax-Span-958"><span class="mrow" id="MathJax-Span-959"><span class="mspace" id="MathJax-Span-960" style="height: 0em; vertical-align: 0em; width: 2em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-961" style="font-family: MathJax_Math-italic;">ρ</span><span class="mo" id="MathJax-Span-962" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-963"><span class="mrow" id="MathJax-Span-964"><span class="mi" id="MathJax-Span-965" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-966" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-967" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">t</span><span class="mo" id="MathJax-Span-968" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-969"><span class="mrow" id="MathJax-Span-970"><span class="mi" id="MathJax-Span-971" style="font-family: MathJax_Main-bold;">v</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.508em;"></span></span><span style="position: absolute; clip: rect(3.022em, 1008.04em, 8.038em, -999.998em); top: -5.758em; left: 12.637em;"><span style="display: inline-block; position: relative; width: 8.038em; height: 0px;"><span style="position: absolute; clip: rect(2.511em, 1007.43em, 5.019em, -999.998em); top: -5.247em; right: 0em;"><span class="mtd" id="MathJax-Span-934"><span class="mrow" id="MathJax-Span-935"><span class="mi" id="MathJax-Span-936"></span><span class="mo" id="MathJax-Span-937" style="font-family: MathJax_Main; padding-left: 0.281em;">=</span><span class="mo" id="MathJax-Span-938" style="font-family: MathJax_Size2; vertical-align: 0.002em; padding-left: 0.281em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.374em;"></span></span><span class="mi" id="MathJax-Span-939" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mo" id="MathJax-Span-940" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-941"><span class="mrow" id="MathJax-Span-942"><span class="mi" id="MathJax-Span-943" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-944" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-945" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-946"><span class="mi" id="MathJax-Span-947" style="font-family: MathJax_Main-bold;">v</span></span></span><span class="mo" id="MathJax-Span-948" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-949" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">t</span><span class="mo" id="MathJax-Span-950" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-951" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="texatom" id="MathJax-Span-952"><span class="mrow" id="MathJax-Span-953"><span class="mi" id="MathJax-Span-954" style="font-family: MathJax_Main-bold;">v</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(2.511em, 1008.04em, 5.019em, -999.998em); top: -2.738em; right: 0em;"><span class="mtd" id="MathJax-Span-972"><span class="mrow" id="MathJax-Span-973"><span class="mi" id="MathJax-Span-974"></span><span class="mo" id="MathJax-Span-975" style="font-family: MathJax_Main; padding-left: 0.281em;">=</span><span class="mo" id="MathJax-Span-976" style="font-family: MathJax_Size2; vertical-align: 0.002em; padding-left: 0.281em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.374em;"></span></span><span class="texatom" id="MathJax-Span-977" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-978"><span class="mi" id="MathJax-Span-979" style="font-family: MathJax_Main-bold;">v</span></span></span><span class="mi" id="MathJax-Span-980" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mo" id="MathJax-Span-981" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-982"><span class="mrow" id="MathJax-Span-983"><span class="mi" id="MathJax-Span-984" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-985" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-986" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-987"><span class="mi" id="MathJax-Span-988" style="font-family: MathJax_Main-bold;">v</span></span></span><span class="mo" id="MathJax-Span-989" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-990" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">t</span><span class="mo" id="MathJax-Span-991" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-992" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="texatom" id="MathJax-Span-993"><span class="mrow" id="MathJax-Span-994"><span class="mi" id="MathJax-Span-995" style="font-family: MathJax_Main-bold;">v</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.762em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.552em; border-left: 0px solid; width: 0px; height: 5.655em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mtext>Density:</mtext></mtd><mtd><mspace width="2em"></mspace><mi>ρ</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><mi>t</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><mo>∫</mo><mi>f</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mo>,</mo><mi>t</mi><mo stretchy="false">)</mo><mi>d</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow></mtd></mtr><mtr><mtd><mtext>Momentum:</mtext></mtd><mtd><mspace width="2em"></mspace><mi>ρ</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><mi>t</mi><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow></mtd><mtd><mi></mi><mo>=</mo><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mi>f</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mo>,</mo><mi>t</mi><mo stretchy="false">)</mo><mi>d</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-52">\begin{align*}
\text{Density:}&\qquad\rho(\xx, t) &= \int f(\xx, \vv, t) d\vv \\
\text{Momentum:}&\qquad\rho(\xx, t) \vv &= \int \vv f(\xx, \vv, t) d\vv \\
\end{align*}</script></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Discretization-of-the-Boltzmann-Equation">Discretization of the Boltzmann Equation<a class="anchor-link" href="http://andrew.gibiansky.com/blog/physics/lattice-boltzmann-method/#Discretization-of-the-Boltzmann-Equation"></a></h2><p>In order to simulate these equations, we must transform them into a set of algebraic equations via discretization. The Lattice Boltzmann Method is based on a somewhat strange discretization – we discretize time and space as usual onto a lattice with fixed width steps, and we discretize velocity into a finite number of potential directions. For example, for a two-dimensional setting, a common velocity discretization uses nine possible values, with <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-996" style="width: 1.071em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.628em, 1000.88em, 2.557em, -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-997"><span class="msubsup" id="MathJax-Span-998"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.393em, 1000.42em, 4.136em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-999" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mn" id="MathJax-Span-1000" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 0.818em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>e</mi><mn>0</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-53">e_0</script> corresponding to a zero velocity:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="./Lattice Boltzmann Method - Andrew Gibiansky_files/d2q9.png"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Consider now the final equation we arrived to:
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;F&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A9;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1001" style="width: 18.211em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.563em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.86em, 1015.47em, 4.508em, -999.998em); top: -3.435em; left: 0em;"><span class="mrow" id="MathJax-Span-1002"><span class="mrow" id="MathJax-Span-1003"><span class="mo" id="MathJax-Span-1004" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span><span class="mrow" id="MathJax-Span-1005"><span class="mfrac" id="MathJax-Span-1006"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1000.56em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.276em;"><span class="mi" id="MathJax-Span-1007" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1000.88em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.462em;"><span class="mrow" id="MathJax-Span-1008"><span class="mi" id="MathJax-Span-1009" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mi" id="MathJax-Span-1010" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1001.07em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.071em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mo" id="MathJax-Span-1011" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="texatom" id="MathJax-Span-1012" style="padding-left: 0.235em;"><span class="mrow" id="MathJax-Span-1013"><span class="mi" id="MathJax-Span-1014" style="font-family: MathJax_Main-bold;">v</span></span></span><span class="mo" id="MathJax-Span-1015" style="font-family: MathJax_Main; padding-left: 0.235em;">⋅</span><span class="msubsup" id="MathJax-Span-1016" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.349em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.79em, 4.183em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1017" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.838em;"><span class="texatom" id="MathJax-Span-1018"><span class="mrow" id="MathJax-Span-1019"><span class="mi" id="MathJax-Span-1020" style="font-size: 70.7%; font-family: MathJax_Main-bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1021" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="mfrac" id="MathJax-Span-1022" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1000.7em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.369em;"><span class="mi" id="MathJax-Span-1023" style="font-family: MathJax_Main-bold;">F</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em, 1000.84em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.416em;"><span class="mi" id="MathJax-Span-1024" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1000.98em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.978em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mo" id="MathJax-Span-1025" style="font-family: MathJax_Main; padding-left: 0.235em;">⋅</span><span class="msubsup" id="MathJax-Span-1026" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.349em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.79em, 4.183em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1027" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.838em;"><span class="texatom" id="MathJax-Span-1028"><span class="mrow" id="MathJax-Span-1029"><span class="mi" id="MathJax-Span-1030" style="font-size: 70.7%; font-family: MathJax_Main-bold;">v</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1031" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span><span class="mi" id="MathJax-Span-1032" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mo" id="MathJax-Span-1033" style="font-family: MathJax_Main; padding-left: 0.281em;">=</span><span class="mi" id="MathJax-Span-1034" style="font-family: MathJax_Main; padding-left: 0.281em;">Ω</span><span class="mo" id="MathJax-Span-1035" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1036" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1037" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1038" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 3.44em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.139em; border-left: 0px solid; width: 0px; height: 2.938em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>(</mo><mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mo>⋅</mo><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></msub><mo>+</mo><mfrac><mi mathvariant="bold">F</mi><mi>m</mi></mfrac><mo>⋅</mo><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow></msub></mrow><mo>)</mo></mrow><mi>f</mi><mo>=</mo><mi mathvariant="normal">Ω</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-54">\left(\p{}{t} + \vv\cdot \nabla_\xx+ \frac{\bf F}{m}\cdot \nabla_\vv\right)f = \Omega(t).</script>
In order to discretize it in the velocity space, consider what happens when we fix a velocity of interest, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-55-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1039" style="width: 3.207em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.743em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.675em, 1002.74em, 2.557em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-1040"><span class="texatom" id="MathJax-Span-1041"><span class="mrow" id="MathJax-Span-1042"><span class="mi" id="MathJax-Span-1043" style="font-family: MathJax_Main-bold;">v</span></span></span><span class="mo" id="MathJax-Span-1044" style="font-family: MathJax_Main; padding-left: 0.281em;">=</span><span class="msubsup" id="MathJax-Span-1045" style="padding-left: 0.281em;"><span style="display: inline-block; position: relative; width: 0.792em; height: 0px;"><span style="position: absolute; clip: rect(3.393em, 1000.42em, 4.136em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1046" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-1047" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.215em; border-left: 0px solid; width: 0px; height: 0.818em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mo>=</mo><msub><mi>e</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-55">\vv = e_i</script>, one of the nine directions shown above. Doing the substitution, we get
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;F&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A9;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1048" style="width: 18.443em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.749em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.86em, 1015.66em, 4.508em, -999.998em); top: -3.435em; left: 0em;"><span class="mrow" id="MathJax-Span-1049"><span class="mrow" id="MathJax-Span-1050"><span class="mo" id="MathJax-Span-1051" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span><span class="mrow" id="MathJax-Span-1052"><span class="mfrac" id="MathJax-Span-1053"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1000.56em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.276em;"><span class="mi" id="MathJax-Span-1054" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1000.88em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.462em;"><span class="mrow" id="MathJax-Span-1055"><span class="mi" id="MathJax-Span-1056" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mi" id="MathJax-Span-1057" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1001.07em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.071em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mo" id="MathJax-Span-1058" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="msubsup" id="MathJax-Span-1059" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 0.792em; height: 0px;"><span style="position: absolute; clip: rect(3.393em, 1000.42em, 4.136em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1060" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-1061" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1062" style="font-family: MathJax_Main; padding-left: 0.235em;">⋅</span><span class="msubsup" id="MathJax-Span-1063" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.349em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.79em, 4.183em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1064" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.838em;"><span class="texatom" id="MathJax-Span-1065"><span class="mrow" id="MathJax-Span-1066"><span class="mi" id="MathJax-Span-1067" style="font-size: 70.7%; font-family: MathJax_Main-bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1068" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="mfrac" id="MathJax-Span-1069" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1000.7em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.369em;"><span class="mi" id="MathJax-Span-1070" style="font-family: MathJax_Main-bold;">F</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em, 1000.84em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.416em;"><span class="mi" id="MathJax-Span-1071" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1000.98em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.978em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mo" id="MathJax-Span-1072" style="font-family: MathJax_Main; padding-left: 0.235em;">⋅</span><span class="msubsup" id="MathJax-Span-1073" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.349em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.79em, 4.183em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1074" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.838em;"><span class="texatom" id="MathJax-Span-1075"><span class="mrow" id="MathJax-Span-1076"><span class="texatom" id="MathJax-Span-1077"><span class="mrow" id="MathJax-Span-1078"><span class="mi" id="MathJax-Span-1079" style="font-size: 70.7%; font-family: MathJax_Main-bold;">v</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1080" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span><span class="mi" id="MathJax-Span-1081" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mo" id="MathJax-Span-1082" style="font-family: MathJax_Main; padding-left: 0.281em;">=</span><span class="mi" id="MathJax-Span-1083" style="font-family: MathJax_Main; padding-left: 0.281em;">Ω</span><span class="mo" id="MathJax-Span-1084" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1085" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1086" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1087" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 3.44em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.139em; border-left: 0px solid; width: 0px; height: 2.938em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>(</mo><mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><msub><mi>e</mi><mi>i</mi></msub><mo>⋅</mo><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></msub><mo>+</mo><mfrac><mi mathvariant="bold">F</mi><mi>m</mi></mfrac><mo>⋅</mo><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow></mrow></msub></mrow><mo>)</mo></mrow><mi>f</mi><mo>=</mo><mi mathvariant="normal">Ω</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-56">\left(\p{}{t} + e_i \cdot \nabla_\xx+ \frac{\bf F}{m}\cdot \nabla_{\vv}\right)f = \Omega(t).</script>
As we know from multivariable calculus, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1088" style="width: 4.044em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.44em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.442em, 1003.44em, 2.604em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-1089"><span class="msubsup" id="MathJax-Span-1090"><span style="display: inline-block; position: relative; width: 0.792em; height: 0px;"><span style="position: absolute; clip: rect(3.393em, 1000.42em, 4.136em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1091" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-1092" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1093" style="font-family: MathJax_Main; padding-left: 0.235em;">⋅</span><span class="msubsup" id="MathJax-Span-1094" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.349em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.79em, 4.183em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1095" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.838em;"><span class="texatom" id="MathJax-Span-1096"><span class="mrow" id="MathJax-Span-1097"><span class="texatom" id="MathJax-Span-1098"><span class="mrow" id="MathJax-Span-1099"><span class="mi" id="MathJax-Span-1100" style="font-size: 70.7%; font-family: MathJax_Main-bold;">x</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mi" id="MathJax-Span-1101" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 1.198em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>e</mi><mi>i</mi></msub><mo>⋅</mo><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></mrow></msub><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-57">e_i \cdot \nabla_{\xx} f</script> is simply the directional derivative in the direction <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1102" style="width: 0.931em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.792em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.628em, 1000.79em, 2.511em, -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-1103"><span class="msubsup" id="MathJax-Span-1104"><span style="display: inline-block; position: relative; width: 0.792em; height: 0px;"><span style="position: absolute; clip: rect(3.393em, 1000.42em, 4.136em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1105" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-1106" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.215em; border-left: 0px solid; width: 0px; height: 0.818em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>e</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-58">e_i</script>; it is the rate of change of the quantity when we move in the direction indicated by <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-59-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1107" style="width: 0.931em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.792em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.628em, 1000.79em, 2.511em, -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-1108"><span class="msubsup" id="MathJax-Span-1109"><span style="display: inline-block; position: relative; width: 0.792em; height: 0px;"><span style="position: absolute; clip: rect(3.393em, 1000.42em, 4.136em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1110" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-1111" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.215em; border-left: 0px solid; width: 0px; height: 0.818em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>e</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-59">e_i</script>.</p>
<p>Next, consider the gradient in velocity space, 
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-60-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1112" style="width: 14.263em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.173em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.86em, 1012.08em, 4.555em, -999.998em); top: -3.435em; left: 0em;"><span class="mrow" id="MathJax-Span-1113"><span class="msubsup" id="MathJax-Span-1114"><span style="display: inline-block; position: relative; width: 1.349em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.79em, 4.183em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1115" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.838em;"><span class="texatom" id="MathJax-Span-1116"><span class="mrow" id="MathJax-Span-1117"><span class="mi" id="MathJax-Span-1118" style="font-size: 70.7%; font-family: MathJax_Main-bold;">v</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mi" id="MathJax-Span-1119" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mo" id="MathJax-Span-1120" style="font-family: MathJax_Main; padding-left: 0.281em;">=</span><span class="mrow" id="MathJax-Span-1121" style="padding-left: 0.281em;"><span class="mo" id="MathJax-Span-1122" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span><span class="mrow" id="MathJax-Span-1123"><span class="mfrac" id="MathJax-Span-1124"><span style="display: inline-block; position: relative; width: 1.767em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1001.12em, 4.322em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.555em;"><span class="mrow" id="MathJax-Span-1125"><span class="mi" id="MathJax-Span-1126" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mi" id="MathJax-Span-1127" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1001.67em, 4.276em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.834em;"><span class="mrow" id="MathJax-Span-1128"><span class="mi" id="MathJax-Span-1129" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="msubsup" id="MathJax-Span-1130"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px;"><span style="position: absolute; clip: rect(3.393em, 1000.56em, 4.136em, -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1131"><span class="mrow" id="MathJax-Span-1132"><span class="mi" id="MathJax-Span-1133" style="font-family: MathJax_Main-bold;">v</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.606em;"><span class="mi" id="MathJax-Span-1134" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1001.77em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.767em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mo" id="MathJax-Span-1135" style="font-family: MathJax_Main;">,</span><span class="mfrac" id="MathJax-Span-1136" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.721em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1001.12em, 4.322em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.555em;"><span class="mrow" id="MathJax-Span-1137"><span class="mi" id="MathJax-Span-1138" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mi" id="MathJax-Span-1139" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1001.58em, 4.415em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.787em;"><span class="mrow" id="MathJax-Span-1140"><span class="mi" id="MathJax-Span-1141" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="msubsup" id="MathJax-Span-1142"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.393em, 1000.56em, 4.136em, -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1143"><span class="mrow" id="MathJax-Span-1144"><span class="mi" id="MathJax-Span-1145" style="font-family: MathJax_Main-bold;">v</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.606em;"><span class="mi" id="MathJax-Span-1146" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1001.72em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.721em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mo" id="MathJax-Span-1147" style="font-family: MathJax_Main;">,</span><span class="mfrac" id="MathJax-Span-1148" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.721em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1001.12em, 4.322em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.555em;"><span class="mrow" id="MathJax-Span-1149"><span class="mi" id="MathJax-Span-1150" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mi" id="MathJax-Span-1151" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1001.58em, 4.276em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.787em;"><span class="mrow" id="MathJax-Span-1152"><span class="mi" id="MathJax-Span-1153" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="msubsup" id="MathJax-Span-1154"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.393em, 1000.56em, 4.136em, -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1155"><span class="mrow" id="MathJax-Span-1156"><span class="mi" id="MathJax-Span-1157" style="font-family: MathJax_Main-bold;">v</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.606em;"><span class="mi" id="MathJax-Span-1158" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1001.72em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.721em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1159" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span><span class="mo" id="MathJax-Span-1160" style="font-family: MathJax_Main; padding-left: 0.188em;">.</span></span><span style="display: inline-block; width: 0px; height: 3.44em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.193em; border-left: 0px solid; width: 0px; height: 2.938em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow></msub><mi>f</mi><mo>=</mo><mrow><mo>(</mo><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mi>x</mi></msub></mrow></mfrac><mo>,</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mi>y</mi></msub></mrow></mfrac><mo>,</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mi>z</mi></msub></mrow></mfrac></mrow><mo>)</mo></mrow><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-60">\nabla_\vv f = \left(\p{f}{\vv_x}, \p{f}{\vv_y}, \p{f}{\vv_z}\right).</script>
In order to proceed, we would need to evaluate <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-61-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1161" style="width: 4.09em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.486em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.396em, 1003.39em, 2.65em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-1162"><span class="msubsup" id="MathJax-Span-1163"><span style="display: inline-block; position: relative; width: 1.349em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.79em, 4.183em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1164" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.838em;"><span class="texatom" id="MathJax-Span-1165"><span class="mrow" id="MathJax-Span-1166"><span class="mi" id="MathJax-Span-1167" style="font-size: 70.7%; font-family: MathJax_Main-bold;">v</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mi" id="MathJax-Span-1168" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mo" id="MathJax-Span-1169" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1170"><span style="display: inline-block; position: relative; width: 0.792em; height: 0px;"><span style="position: absolute; clip: rect(3.393em, 1000.42em, 4.136em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1171" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-1172" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1173" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.323em; border-left: 0px solid; width: 0px; height: 1.307em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow></msub><mi>f</mi><mo stretchy="false">(</mo><msub><mi>e</mi><mi>i</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-61">\nabla_\vv f(e_i)</script>, which we cannot do in generality. Thus, we assume that <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-62-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;F&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1174" style="width: 0.885em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.746em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.442em, 1000.7em, 2.418em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-1175"><span class="mi" id="MathJax-Span-1176" style="font-family: MathJax_Main-bold;">F</span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold">F</mi></math></span></span><script type="math/tex" id="MathJax-Element-62">\bf F</script> is zero for the time being; there are <a href="http://eprints.port.ac.uk/15502/1/010j.pdf">several approaches</a> to integrating body forces into the Lattice Boltzmann method, but they mostly group the body forces into the collision term, which we will deal with later.</p>
<p>Under this assumption, our equation reduces to
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-63-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A9;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1177" style="width: 13.055em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.151em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.86em, 1011.06em, 4.508em, -999.998em); top: -3.435em; left: 0em;"><span class="mrow" id="MathJax-Span-1178"><span class="mrow" id="MathJax-Span-1179"><span class="mo" id="MathJax-Span-1180" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span><span class="mrow" id="MathJax-Span-1181"><span class="mfrac" id="MathJax-Span-1182"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em, 1000.56em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.276em;"><span class="mi" id="MathJax-Span-1183" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1000.88em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.462em;"><span class="mrow" id="MathJax-Span-1184"><span class="mi" id="MathJax-Span-1185" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mi" id="MathJax-Span-1186" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1001.07em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.071em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mo" id="MathJax-Span-1187" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="msubsup" id="MathJax-Span-1188" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 0.792em; height: 0px;"><span style="position: absolute; clip: rect(3.393em, 1000.42em, 4.136em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1189" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-1190" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1191" style="font-family: MathJax_Main; padding-left: 0.235em;">⋅</span><span class="msubsup" id="MathJax-Span-1192" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.349em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.79em, 4.183em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1193" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.838em;"><span class="texatom" id="MathJax-Span-1194"><span class="mrow" id="MathJax-Span-1195"><span class="mi" id="MathJax-Span-1196" style="font-size: 70.7%; font-family: MathJax_Main-bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1197" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span><span class="mi" id="MathJax-Span-1198" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mo" id="MathJax-Span-1199" style="font-family: MathJax_Main; padding-left: 0.281em;">=</span><span class="mi" id="MathJax-Span-1200" style="font-family: MathJax_Main; padding-left: 0.281em;">Ω</span><span class="mo" id="MathJax-Span-1201" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1202" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1203" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1204" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 3.44em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.139em; border-left: 0px solid; width: 0px; height: 2.938em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>(</mo><mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><msub><mi>e</mi><mi>i</mi></msub><mo>⋅</mo><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></msub></mrow><mo>)</mo></mrow><mi>f</mi><mo>=</mo><mi mathvariant="normal">Ω</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-63">\left(\p{}{t} + e_i \cdot \nabla_\xx\right)f = \Omega(t).</script>
If we let <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-64-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1205" style="width: 0.931em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.792em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.396em, 1000.79em, 2.557em, -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-1206"><span class="msubsup" id="MathJax-Span-1207"><span style="display: inline-block; position: relative; width: 0.792em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.56em, 4.322em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1208" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.513em;"><span class="mi" id="MathJax-Span-1209" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 1.198em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-64">f_i</script> be <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-65-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1210" style="width: 4.694em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.997em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.396em, 1003.9em, 2.65em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-1211"><span class="mi" id="MathJax-Span-1212" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mo" id="MathJax-Span-1213" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1214"><span class="mrow" id="MathJax-Span-1215"><span class="mi" id="MathJax-Span-1216" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-1217" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1218" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.792em; height: 0px;"><span style="position: absolute; clip: rect(3.393em, 1000.42em, 4.136em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1219" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-1220" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1221" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1222" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">t</span><span class="mo" id="MathJax-Span-1223" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.323em; border-left: 0px solid; width: 0px; height: 1.307em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><msub><mi>e</mi><mi>i</mi></msub><mo>,</mo><mi>t</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-65">f(\xx, e_i, t)</script>, this becomes
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-66-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A9;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1224" style="width: 18.676em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.935em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.396em, 1015.84em, 2.65em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-1225"><span class="msubsup" id="MathJax-Span-1226"><span style="display: inline-block; position: relative; width: 0.792em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.56em, 4.322em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1227" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.513em;"><span class="mi" id="MathJax-Span-1228" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1229" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1230"><span class="mrow" id="MathJax-Span-1231"><span class="mi" id="MathJax-Span-1232" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-1233" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="msubsup" id="MathJax-Span-1234" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 0.792em; height: 0px;"><span style="position: absolute; clip: rect(3.393em, 1000.42em, 4.136em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1235" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-1236" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mi" id="MathJax-Span-1237" style="font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1238" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1239" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1240" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">t</span><span class="mo" id="MathJax-Span-1241" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="mi" id="MathJax-Span-1242" style="font-family: MathJax_Math-italic; padding-left: 0.235em;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1243" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1244" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1245" style="font-family: MathJax_Main; padding-left: 0.235em;">−</span><span class="msubsup" id="MathJax-Span-1246" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 0.792em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.56em, 4.322em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1247" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.513em;"><span class="mi" id="MathJax-Span-1248" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1249" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1250"><span class="mrow" id="MathJax-Span-1251"><span class="mi" id="MathJax-Span-1252" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-1253" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1254" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">t</span><span class="mo" id="MathJax-Span-1255" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1256" style="font-family: MathJax_Main; padding-left: 0.281em;">=</span><span class="msubsup" id="MathJax-Span-1257" style="padding-left: 0.281em;"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.7em, 4.136em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1258" style="font-family: MathJax_Main;">Ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.746em;"><span class="mi" id="MathJax-Span-1259" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1260" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1261" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1262" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1263" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.323em; border-left: 0px solid; width: 0px; height: 1.307em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>f</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>+</mo><msub><mi>e</mi><mi>i</mi></msub><mi>δ</mi><mi>t</mi><mo>,</mo><mi>t</mi><mo>+</mo><mi>δ</mi><mi>t</mi><mo stretchy="false">)</mo><mo>−</mo><msub><mi>f</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi mathvariant="normal">Ω</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-66">f_i(\xx + e_i \delta t, t + \delta t) - f_i(\xx, t) = \Omega_i(t).</script></p>
<p>The collision term <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-67-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A9;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1264" style="width: 0.885em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.746em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.442em, 1000.7em, 2.418em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-1265"><span class="mi" id="MathJax-Span-1266" style="font-family: MathJax_Main;">Ω</span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Ω</mi></math></span></span><script type="math/tex" id="MathJax-Element-67">\Omega</script> is the last remaining bit, but it turns out to be incredibly complex in general. For the purposes of our simulation, we make a very common assumption known as the Bhatnagar-Gross-Krook (BGK) assumption: that the collision term simply forces the distribution to slowly decay to an equilibrium distribution <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-68-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mtext&gt;eq&lt;/mtext&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1267" style="width: 1.628em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.396em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.396em, 1001.4em, 2.557em, -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-1268"><span class="msubsup" id="MathJax-Span-1269"><span style="display: inline-block; position: relative; width: 1.396em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.56em, 4.322em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1270" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.364em; left: 0.606em;"><span class="mtext" id="MathJax-Span-1271" style="font-size: 70.7%; font-family: MathJax_Main;">eq</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 1.198em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>f</mi><mtext>eq</mtext></msup></math></span></span><script type="math/tex" id="MathJax-Element-68">f^\text{eq}</script>, and thus that
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-69-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A9;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;/mfrac&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mtext&gt;eq&lt;/mtext&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1272" style="width: 9.525em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.131em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(0.885em, 1008.04em, 3.207em, -999.998em); top: -2.367em; left: 0em;"><span class="mrow" id="MathJax-Span-1273"><span class="msubsup" id="MathJax-Span-1274"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.7em, 4.136em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1275" style="font-family: MathJax_Main;">Ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.746em;"><span class="mi" id="MathJax-Span-1276" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1277" style="font-family: MathJax_Main; padding-left: 0.281em;">=</span><span class="mfrac" id="MathJax-Span-1278" style="padding-left: 0.281em;"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.207em, 1000.42em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.23em;"><span class="mn" id="MathJax-Span-1279" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.44em, 1000.51em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.276em;"><span class="mi" id="MathJax-Span-1280" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1000.65em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.653em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1281"><span class="mo" id="MathJax-Span-1282" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">(</span></span><span class="mrow" id="MathJax-Span-1283"><span class="msubsup" id="MathJax-Span-1284"><span style="display: inline-block; position: relative; width: 1.396em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.56em, 4.322em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1285" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.533em, 1000.75em, 4.276em, -999.998em); top: -4.457em; left: 0.606em;"><span class="mtext" id="MathJax-Span-1286" style="font-size: 70.7%; font-family: MathJax_Main;">eq</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em, 1000.33em, 4.136em, -999.998em); top: -3.667em; left: 0.513em;"><span class="mi" id="MathJax-Span-1287" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1288" style="font-family: MathJax_Main; padding-left: 0.235em;">−</span><span class="msubsup" id="MathJax-Span-1289" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 0.792em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.56em, 4.322em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1290" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.513em;"><span class="mi" id="MathJax-Span-1291" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1292" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">)</span></span></span><span class="mo" id="MathJax-Span-1293" style="font-family: MathJax_Main; padding-left: 0.188em;">.</span></span><span style="display: inline-block; width: 0px; height: 2.371em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.867em; border-left: 0px solid; width: 0px; height: 2.503em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi mathvariant="normal">Ω</mi><mi>i</mi></msub><mo>=</mo><mfrac><mn>1</mn><mi>τ</mi></mfrac><mrow><mo>(</mo><mrow><msubsup><mi>f</mi><mi>i</mi><mtext>eq</mtext></msubsup><mo>−</mo><msub><mi>f</mi><mi>i</mi></msub></mrow><mo>)</mo></mrow><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-69">\Omega_i = \frac{1}{\tau}\left(f_i^\text{eq} - f_i\right).</script>
The equilibrium distribution is effectively a smoothed version of the current distribution, recomputed from the bulk properties <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-70-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C1;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1294" style="width: 0.606em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.628em, 1000.51em, 2.604em, -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-1295"><span class="mi" id="MathJax-Span-1296" style="font-family: MathJax_Math-italic;">ρ</span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.323em; border-left: 0px solid; width: 0px; height: 0.872em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ρ</mi></math></span></span><script type="math/tex" id="MathJax-Element-70">\rho</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-71-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1297" style="width: 0.792em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.675em, 1000.65em, 2.418em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-1298"><span class="mi" id="MathJax-Span-1299" style="font-family: MathJax_Main-bold;">u</span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.655em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold">u</mi></math></span></span><script type="math/tex" id="MathJax-Element-71">\bf u</script> (bulk velocity). The equilibrium represents an expected distribution which would result in the observed bulk properties, and several assumptions are necessary to justify any particular form for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-72-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mtext&gt;eq&lt;/mtext&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1300" style="width: 1.628em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.396em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.396em, 1001.4em, 2.557em, -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-1301"><span class="msubsup" id="MathJax-Span-1302"><span style="display: inline-block; position: relative; width: 1.396em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.56em, 4.322em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1303" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.364em; left: 0.606em;"><span class="mtext" id="MathJax-Span-1304" style="font-size: 70.7%; font-family: MathJax_Main;">eq</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 1.198em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>f</mi><mtext>eq</mtext></msup></math></span></span><script type="math/tex" id="MathJax-Element-72">f^\text{eq}</script>. A commonly used form that was proposed for the BGK assumption is 
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-73-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mtext&gt;eq&lt;/mtext&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;&amp;#x03C1;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/mfrac&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;9&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;msup&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/mrow&gt;&lt;msup&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1305" style="width: 24.947em; display: inline-block;"><span style="display: inline-block; position: relative; width: 21.323em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.767em, 1021.23em, 4.508em, -999.998em); top: -3.435em; left: 0em;"><span class="mrow" id="MathJax-Span-1306"><span class="msubsup" id="MathJax-Span-1307"><span style="display: inline-block; position: relative; width: 1.396em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.56em, 4.322em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1308" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.533em, 1000.75em, 4.276em, -999.998em); top: -4.457em; left: 0.606em;"><span class="mtext" id="MathJax-Span-1309" style="font-size: 70.7%; font-family: MathJax_Main;">eq</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em, 1000.33em, 4.136em, -999.998em); top: -3.667em; left: 0.513em;"><span class="mi" id="MathJax-Span-1310" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1311" style="font-family: MathJax_Main; padding-left: 0.281em;">=</span><span class="msubsup" id="MathJax-Span-1312" style="padding-left: 0.281em;"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px;"><span style="position: absolute; clip: rect(3.393em, 1000.61em, 4.136em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1313" style="font-family: MathJax_Math-italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.606em;"><span class="mi" id="MathJax-Span-1314" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mi" id="MathJax-Span-1315" style="font-family: MathJax_Math-italic;">ρ</span><span class="mrow" id="MathJax-Span-1316" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-1317" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span><span class="mrow" id="MathJax-Span-1318"><span class="mn" id="MathJax-Span-1319" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1320" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="mn" id="MathJax-Span-1321" style="font-family: MathJax_Main; padding-left: 0.235em;">3</span><span class="mfrac" id="MathJax-Span-1322"><span style="display: inline-block; position: relative; width: 2.232em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.393em, 1002.09em, 4.276em, -999.998em); top: -4.689em; left: 50%; margin-left: -1.066em;"><span class="mrow" id="MathJax-Span-1323"><span class="msubsup" id="MathJax-Span-1324"><span style="display: inline-block; position: relative; width: 0.792em; height: 0px;"><span style="position: absolute; clip: rect(3.393em, 1000.42em, 4.136em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1325" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-1326" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1327" style="font-family: MathJax_Main; padding-left: 0.235em;">⋅</span><span class="mi" id="MathJax-Span-1328" style="font-family: MathJax_Math-italic; padding-left: 0.235em;">u</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em, 1000.42em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.23em;"><span class="mi" id="MathJax-Span-1329" style="font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1002.23em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.232em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mo" id="MathJax-Span-1330" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="mfrac" id="MathJax-Span-1331" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 0.606em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.207em, 1000.47em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.23em;"><span class="mn" id="MathJax-Span-1332" style="font-family: MathJax_Main;">9</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.207em, 1000.47em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.23em;"><span class="mn" id="MathJax-Span-1333" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1000.61em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.606em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-1334"><span style="display: inline-block; position: relative; width: 3.44em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.022em, 1003.3em, 4.369em, -999.998em); top: -4.689em; left: 50%; margin-left: -1.67em;"><span class="mrow" id="MathJax-Span-1335"><span class="mo" id="MathJax-Span-1336" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1337"><span style="display: inline-block; position: relative; width: 0.792em; height: 0px;"><span style="position: absolute; clip: rect(3.393em, 1000.42em, 4.136em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1338" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-1339" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1340" style="font-family: MathJax_Main; padding-left: 0.235em;">⋅</span><span class="mi" id="MathJax-Span-1341" style="font-family: MathJax_Math-italic; padding-left: 0.235em;">u</span><span class="msubsup" id="MathJax-Span-1342"><span style="display: inline-block; position: relative; width: 0.838em; height: 0px;"><span style="position: absolute; clip: rect(3.115em, 1000.28em, 4.369em, -999.998em); top: -3.992em; left: 0em;"><span class="mo" id="MathJax-Span-1343" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.364em; left: 0.374em;"><span class="mn" id="MathJax-Span-1344" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.115em, 1000.88em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.416em;"><span class="msubsup" id="MathJax-Span-1345"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.393em, 1000.42em, 4.136em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1346" style="font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.271em; left: 0.42em;"><span class="mn" id="MathJax-Span-1347" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1003.44em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.44em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mo" id="MathJax-Span-1348" style="font-family: MathJax_Main; padding-left: 0.235em;">−</span><span class="mfrac" id="MathJax-Span-1349" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 0.606em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.207em, 1000.47em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.23em;"><span class="mn" id="MathJax-Span-1350" style="font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.207em, 1000.47em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.23em;"><span class="mn" id="MathJax-Span-1351" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1000.61em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.606em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-1352"><span style="display: inline-block; position: relative; width: 2em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.393em, 1001.86em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.927em;"><span class="mrow" id="MathJax-Span-1353"><span class="mi" id="MathJax-Span-1354" style="font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-1355" style="font-family: MathJax_Main; padding-left: 0.235em;">⋅</span><span class="mi" id="MathJax-Span-1356" style="font-family: MathJax_Math-italic; padding-left: 0.235em;">u</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.115em, 1000.88em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.416em;"><span class="msubsup" id="MathJax-Span-1357"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.393em, 1000.42em, 4.136em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1358" style="font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.271em; left: 0.42em;"><span class="mn" id="MathJax-Span-1359" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1002em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1360" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span><span class="mo" id="MathJax-Span-1361" style="font-family: MathJax_Main; padding-left: 0.188em;">.</span></span><span style="display: inline-block; width: 0px; height: 3.44em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.139em; border-left: 0px solid; width: 0px; height: 3.046em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msubsup><mi>f</mi><mi>i</mi><mtext>eq</mtext></msubsup><mo>=</mo><msub><mi>ω</mi><mi>i</mi></msub><mi>ρ</mi><mrow><mo>(</mo><mrow><mn>1</mn><mo>+</mo><mn>3</mn><mfrac><mrow><msub><mi>e</mi><mi>i</mi></msub><mo>⋅</mo><mi>u</mi></mrow><mi>c</mi></mfrac><mo>+</mo><mfrac><mn>9</mn><mn>2</mn></mfrac><mfrac><mrow><mo stretchy="false">(</mo><msub><mi>e</mi><mi>i</mi></msub><mo>⋅</mo><mi>u</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><msup><mi>c</mi><mn>2</mn></msup></mfrac><mo>−</mo><mfrac><mn>3</mn><mn>2</mn></mfrac><mfrac><mrow><mi>u</mi><mo>⋅</mo><mi>u</mi></mrow><msup><mi>c</mi><mn>2</mn></msup></mfrac></mrow><mo>)</mo></mrow><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-73">f_i^\text{eq} = \omega_i \rho \left(1 + 3\frac{e_i \cdot u}{c} + \frac92 \frac{(e_i \cdot u)^2}{c^2} - \frac32 \frac{u\cdot u}{c^2}\right).</script>
where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-74-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1362" style="width: 1.117em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.628em, 1000.93em, 2.511em, -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-1363"><span class="msubsup" id="MathJax-Span-1364"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px;"><span style="position: absolute; clip: rect(3.393em, 1000.61em, 4.136em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1365" style="font-family: MathJax_Math-italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.606em;"><span class="mi" id="MathJax-Span-1366" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.215em; border-left: 0px solid; width: 0px; height: 0.818em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>ω</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-74">\omega_i</script> is a weighting function dependent on the exact velocity discretization.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Lattice-Boltzmann-Method-Implementation">Lattice Boltzmann Method Implementation<a class="anchor-link" href="http://andrew.gibiansky.com/blog/physics/lattice-boltzmann-method/#Lattice-Boltzmann-Method-Implementation"></a></h3><p>To implement the LBM method, we separate the solution of the equation
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-75-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A9;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1367" style="width: 18.676em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.935em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.396em, 1015.84em, 2.65em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-1368"><span class="msubsup" id="MathJax-Span-1369"><span style="display: inline-block; position: relative; width: 0.792em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.56em, 4.322em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1370" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.513em;"><span class="mi" id="MathJax-Span-1371" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1372" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1373"><span class="mrow" id="MathJax-Span-1374"><span class="mi" id="MathJax-Span-1375" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-1376" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="msubsup" id="MathJax-Span-1377" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 0.792em; height: 0px;"><span style="position: absolute; clip: rect(3.393em, 1000.42em, 4.136em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1378" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-1379" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mi" id="MathJax-Span-1380" style="font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1381" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1382" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1383" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">t</span><span class="mo" id="MathJax-Span-1384" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="mi" id="MathJax-Span-1385" style="font-family: MathJax_Math-italic; padding-left: 0.235em;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1386" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1387" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1388" style="font-family: MathJax_Main; padding-left: 0.235em;">−</span><span class="msubsup" id="MathJax-Span-1389" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 0.792em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.56em, 4.322em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1390" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.513em;"><span class="mi" id="MathJax-Span-1391" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1392" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1393"><span class="mrow" id="MathJax-Span-1394"><span class="mi" id="MathJax-Span-1395" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-1396" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1397" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">t</span><span class="mo" id="MathJax-Span-1398" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1399" style="font-family: MathJax_Main; padding-left: 0.281em;">=</span><span class="msubsup" id="MathJax-Span-1400" style="padding-left: 0.281em;"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.7em, 4.136em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1401" style="font-family: MathJax_Main;">Ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.746em;"><span class="mi" id="MathJax-Span-1402" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1403" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1404" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1405" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1406" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.323em; border-left: 0px solid; width: 0px; height: 1.307em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>f</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>+</mo><msub><mi>e</mi><mi>i</mi></msub><mi>δ</mi><mi>t</mi><mo>,</mo><mi>t</mi><mo>+</mo><mi>δ</mi><mi>t</mi><mo stretchy="false">)</mo><mo>−</mo><msub><mi>f</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi mathvariant="normal">Ω</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-75">f_i(\xx + e_i \delta t, t + \delta t) - f_i(\xx, t) = \Omega_i(t).</script>
into two steps, referred to as <em>streaming</em> and <em>collision</em> steps. This approach is somewhat analogous to the common splitting mechanism used in solutions to the Navier-Stokes equations.</p>
<p>The streaming step takes care of fluid movement and propagation, the left side of the equation. As it does not deal with collisions, it can be done entirely separately for each of the discrete velocities, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-76-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1407" style="width: 0.931em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.792em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.628em, 1000.79em, 2.511em, -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-1408"><span class="msubsup" id="MathJax-Span-1409"><span style="display: inline-block; position: relative; width: 0.792em; height: 0px;"><span style="position: absolute; clip: rect(3.393em, 1000.42em, 4.136em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1410" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-1411" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.215em; border-left: 0px solid; width: 0px; height: 0.818em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>e</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-76">e_i</script>. The distribution for a velocity <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-77-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1412" style="width: 0.931em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.792em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.628em, 1000.79em, 2.511em, -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-1413"><span class="msubsup" id="MathJax-Span-1414"><span style="display: inline-block; position: relative; width: 0.792em; height: 0px;"><span style="position: absolute; clip: rect(3.393em, 1000.42em, 4.136em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1415" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-1416" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.215em; border-left: 0px solid; width: 0px; height: 0.818em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>e</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-77">e_i</script> at step <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-78-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1417" style="width: 2.696em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.278em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.442em, 1002.19em, 2.511em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-1418"><span class="mi" id="MathJax-Span-1419" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-1420" style="font-family: MathJax_Main; padding-left: 0.235em;">+</span><span class="mn" id="MathJax-Span-1421" style="font-family: MathJax_Main; padding-left: 0.235em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.16em; border-left: 0px solid; width: 0px; height: 1.035em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-78">k+1</script> for any grid point <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-79-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1422" style="width: 0.746em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.606em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.675em, 1000.61em, 2.418em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-1423"><span class="texatom" id="MathJax-Span-1424"><span class="mrow" id="MathJax-Span-1425"><span class="mi" id="MathJax-Span-1426" style="font-family: MathJax_Main-bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.655em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-79">\xx</script> is computed by looking up the distribution at <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-80-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1427" style="width: 4.508em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.858em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.442em, 1003.81em, 2.557em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-1428"><span class="texatom" id="MathJax-Span-1429"><span class="mrow" id="MathJax-Span-1430"><span class="mi" id="MathJax-Span-1431" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-1432" style="font-family: MathJax_Main; padding-left: 0.235em;">−</span><span class="msubsup" id="MathJax-Span-1433" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 0.792em; height: 0px;"><span style="position: absolute; clip: rect(3.393em, 1000.42em, 4.136em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1434" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-1435" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mi" id="MathJax-Span-1436" style="font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-1437" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.215em; border-left: 0px solid; width: 0px; height: 1.144em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>−</mo><msub><mi>e</mi><mi>i</mi></msub><mi mathvariant="normal">Δ</mi><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-80">\xx - e_i \Delta t</script>, which should just be one grid point away.</p>
<p>The streaming step is also where one must deal with some types of boundary conditions. The simplest type of boundary condition is simply the bounce-back boundary condition, that fluid incoming at a point hits a wall and bounces back. If the wall is at the edge of the fluid boundary, this is fairly simple. The fluid distribution with a velocity going <em>away</em> from the wall is determined not by some point beyond the wall (there is no fluid there!), but rather by the fluid coming <em>into</em> the wall with the opposite velocity.</p>
<p>After the streaming step, the collision step takes care of the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-81-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A9;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1438" style="width: 0.885em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.746em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.442em, 1000.7em, 2.418em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-1439"><span class="mi" id="MathJax-Span-1440" style="font-family: MathJax_Main;">Ω</span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Ω</mi></math></span></span><script type="math/tex" id="MathJax-Element-81">\Omega</script> term. As we discussed earlier, the BGK approximation simply assumes that the net effect of all the collisions is to relax the distribution to some "equilibrium" distribution <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-82-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mtext&gt;eq&lt;/mtext&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1441" style="width: 1.628em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.396em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.396em, 1001.4em, 2.557em, -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-1442"><span class="msubsup" id="MathJax-Span-1443"><span style="display: inline-block; position: relative; width: 1.396em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.56em, 4.322em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1444" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.364em; left: 0.606em;"><span class="mtext" id="MathJax-Span-1445" style="font-size: 70.7%; font-family: MathJax_Main;">eq</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 1.198em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>f</mi><mtext>eq</mtext></msup></math></span></span><script type="math/tex" id="MathJax-Element-82">f^\text{eq}</script>. Thus, the collision step is simply the computation of this equilibrium, along with the relaxation update
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-83-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;:=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;/mfrac&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mtext&gt;eq&lt;/mtext&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1446" style="width: 11.94em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.175em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(0.885em, 1010.08em, 3.207em, -999.998em); top: -2.367em; left: 0em;"><span class="mrow" id="MathJax-Span-1447"><span class="msubsup" id="MathJax-Span-1448"><span style="display: inline-block; position: relative; width: 0.792em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.56em, 4.322em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1449" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.513em;"><span class="mi" id="MathJax-Span-1450" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1451" style="font-family: MathJax_Main; padding-left: 0.281em;">:<span style="font-family: MathJax_Main;">=</span></span><span class="msubsup" id="MathJax-Span-1452" style="padding-left: 0.281em;"><span style="display: inline-block; position: relative; width: 0.792em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.56em, 4.322em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1453" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.513em;"><span class="mi" id="MathJax-Span-1454" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1455" style="font-family: MathJax_Main; padding-left: 0.235em;">−</span><span class="mfrac" id="MathJax-Span-1456" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.207em, 1000.42em, 4.136em, -999.998em); top: -4.689em; left: 50%; margin-left: -0.23em;"><span class="mn" id="MathJax-Span-1457" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.44em, 1000.51em, 4.136em, -999.998em); top: -3.296em; left: 50%; margin-left: -0.276em;"><span class="mi" id="MathJax-Span-1458" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1000.65em, 1.21em, -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.653em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1459"><span class="mo" id="MathJax-Span-1460" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">(</span></span><span class="mrow" id="MathJax-Span-1461"><span class="msubsup" id="MathJax-Span-1462"><span style="display: inline-block; position: relative; width: 1.396em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.56em, 4.322em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1463" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.533em, 1000.75em, 4.276em, -999.998em); top: -4.457em; left: 0.606em;"><span class="mtext" id="MathJax-Span-1464" style="font-size: 70.7%; font-family: MathJax_Main;">eq</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em, 1000.33em, 4.136em, -999.998em); top: -3.667em; left: 0.513em;"><span class="mi" id="MathJax-Span-1465" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1466" style="font-family: MathJax_Main; padding-left: 0.235em;">−</span><span class="msubsup" id="MathJax-Span-1467" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 0.792em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.56em, 4.322em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1468" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.513em;"><span class="mi" id="MathJax-Span-1469" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1470" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">)</span></span></span><span class="mo" id="MathJax-Span-1471" style="font-family: MathJax_Main; padding-left: 0.188em;">.</span></span><span style="display: inline-block; width: 0px; height: 2.371em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.867em; border-left: 0px solid; width: 0px; height: 2.503em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>f</mi><mi>i</mi></msub><mo>:=</mo><msub><mi>f</mi><mi>i</mi></msub><mo>−</mo><mfrac><mn>1</mn><mi>τ</mi></mfrac><mrow><mo>(</mo><mrow><msubsup><mi>f</mi><mi>i</mi><mtext>eq</mtext></msubsup><mo>−</mo><msub><mi>f</mi><mi>i</mi></msub></mrow><mo>)</mo></mrow><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-83">f_i := f_i - \frac{1}{\tau}\left(f_i^\text{eq} - f_i\right).</script></p>
<p>To summarize, an implementation of the LBM method goes through the following steps:</p>
<ol>
<li><strong>Initialization:</strong> Initialize a velocity distribution, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-84-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1472" style="width: 0.931em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.792em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.396em, 1000.79em, 2.557em, -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-1473"><span class="msubsup" id="MathJax-Span-1474"><span style="display: inline-block; position: relative; width: 0.792em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.56em, 4.322em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1475" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.513em;"><span class="mi" id="MathJax-Span-1476" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 1.198em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-84">f_i</script>; then compute the initial equilibrium distribution, initial density, and initial velocity, as described previously.</li>
<li><strong>Streaming:</strong> Update each <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-85-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1477" style="width: 0.931em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.792em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.396em, 1000.79em, 2.557em, -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-1478"><span class="msubsup" id="MathJax-Span-1479"><span style="display: inline-block; position: relative; width: 0.792em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.56em, 4.322em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1480" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.513em;"><span class="mi" id="MathJax-Span-1481" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 1.198em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-85">f_i</script> by propagating the fluid distribution in the direction <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-86-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1482" style="width: 0.931em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.792em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.628em, 1000.79em, 2.511em, -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-1483"><span class="msubsup" id="MathJax-Span-1484"><span style="display: inline-block; position: relative; width: 0.792em; height: 0px;"><span style="position: absolute; clip: rect(3.393em, 1000.42em, 4.136em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1485" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-1486" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.215em; border-left: 0px solid; width: 0px; height: 0.818em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>e</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-86">e_i</script>, applying bounce-back conditions as necessary.</li>
<li><strong>Collision:</strong> Compute the bulk properties density <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-87-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C1;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1487" style="width: 0.606em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.628em, 1000.51em, 2.604em, -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-1488"><span class="mi" id="MathJax-Span-1489" style="font-family: MathJax_Math-italic;">ρ</span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.323em; border-left: 0px solid; width: 0px; height: 0.872em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ρ</mi></math></span></span><script type="math/tex" id="MathJax-Element-87">\rho</script> and velocity <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-88-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1490" style="width: 0.792em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.675em, 1000.65em, 2.418em, -999.998em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-1491"><span class="mi" id="MathJax-Span-1492" style="font-family: MathJax_Main-bold;">u</span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.655em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold">u</mi></math></span></span><script type="math/tex" id="MathJax-Element-88">\bf u</script>. Use these to compute the equilibrium distribution <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-89-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mtext&gt;eq&lt;/mtext&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1493" style="width: 1.628em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.396em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.303em, 1001.4em, 2.696em, -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-1494"><span class="msubsup" id="MathJax-Span-1495"><span style="display: inline-block; position: relative; width: 1.396em; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000.56em, 4.322em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1496" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.533em, 1000.75em, 4.276em, -999.998em); top: -4.457em; left: 0.606em;"><span class="mtext" id="MathJax-Span-1497" style="font-size: 70.7%; font-family: MathJax_Main;">eq</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em, 1000.33em, 4.136em, -999.998em); top: -3.667em; left: 0.513em;"><span class="mi" id="MathJax-Span-1498" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.432em; border-left: 0px solid; width: 0px; height: 1.416em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>f</mi><mi>i</mi><mtext>eq</mtext></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-89">f_i^\text{eq}</script>. Then, relax the fluid distribution to the equilibrium.</li>
<li><strong>Loop:</strong> Repeat streaming and collision indefinitely to simulate fluid motion.</li>
</ol>
<p>The nice thing about the Lattice Boltzmann method is that it is easy to implement and almost trivially parallel, making it the perfect target for acceleration via GPUs and OpenCL/CUDA. A simple implementation I wrote in less than 300 lines is available <a href="https://github.com/gibiansky/experiments/tree/master/lbm">on Github</a>, yielding the following mesmerizing two-dimensional flows:</p>
<iframe width="420" height="315" src="./Lattice Boltzmann Method - Andrew Gibiansky_files/Ic3AvpGWyJ4.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Conclusion">Conclusion<a class="anchor-link" href="http://andrew.gibiansky.com/blog/physics/lattice-boltzmann-method/#Conclusion"></a></h2><p>All in all, the Lattice Boltzmann method is a very interesting alternative to the traditional route of fluid simulation via discretization of the Navier-Stokes equations. On first glance, it seems that is is much less mathematically motivated; however, it seems like there are some very deep connections between the Boltzmann equation and the Navier-Stokes equations, which may be quite difficult to untangle. Others <a href="http://www.mat.ucm.es/~ln06/pdfs/FGolseLN06.pdf">have managed</a> to successfully relate (through a few assumptions about fluid behaviour) the Boltzmann transport equation to the Euler equations and the Navier-Stokes equations for incompressible fluid flow. However, understanding exactly why the Lattice Boltzmann method works as a suitable alternative to the Navier-Stokes equations requires some more work; in particular, it seems like creating <em>physically-realistic</em> flows for the purposes of engineering and simulation may be easier in a Navier-Stokes setting. Plenty of research has gone into these fields in the past ten years, so the papers are out there – but understanding them is a task for another day.</p>

</div>
</div>
</div>
 

</div>


  <footer>
    <p class="meta">
      Friday, December 19, 2014 - Posted in <a href="http://andrew.gibiansky.com/blog/categories/physics">physics</a>, <a href="http://andrew.gibiansky.com/blog/categories/simulations">simulations</a>
    </p>

    <p class="meta">
      
        <a class="basic-alignment left" href="http://andrew.gibiansky.com/blog/haskell/finger-trees" title="Previous Post: Finger Trees">« Finger Trees</a>
      
      
        <a class="basic-alignment right" href="http://andrew.gibiansky.com/blog/verification/writing-a-sat-solver" title="Next Post: Writing a SAT Solver">Writing a SAT Solver »</a>
      
    </p>
  </footer>

</article>
</div>

<aside class="sidebar">
  <section>
    <h1>Contact</h1>

    <p>
      If you've got questions, comments, suggestions, or just want to talk, feel
      free to email me at andrew.gibiansky on Gmail.
    </p>

    <img src="./Lattice Boltzmann Method - Andrew Gibiansky_files/photo.jpg" alt="photo">
  </section>


  <section>
    <h1>Recent Posts <a href="http://andrew.gibiansky.com/feed.rss">(RSS)</a></h1>

    <ul id="recent_posts">
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/machine-learning/baidu-allreduce">Bringing HPC Techniques to Deep Learning</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/machine-learning/nram-2">NRAM: Theano Implementation</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/machine-learning/nram-1">NRAM: Neural Random Access Memory</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/command-line/jq-primer">jq Primer: Munging JSON Data</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/thoughts/engineering-practices">Creating a Culture of Good Engineering</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/genetics/technique-primers">Common Techniques in Molecular Biology</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/genetics/crispr">CRISPR Gene Editing</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/machine-learning/coding-intro-to-nns">Quick Coding Intro to Neural Networks</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/verification/writing-a-sat-solver">Writing a SAT Solver</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/physics/lattice-boltzmann-method">Lattice Boltzmann Method</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/haskell/finger-trees">Finger Trees</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/haskell/haskell-abstractions">Abstraction in Haskell (Monoids, Functors, Monads)</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/haskell/haskell-typeclasses">Typeclasses: Polymorphism in Haskell</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/haskell/haskell-gloss">Your First Haskell Application (with Gloss)</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/haskell/haskell-syntax">Intro to Haskell Syntax</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/linguistics/why-syntax">Linguistics and Syntax</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/machine-learning/speech-recognition-neural-networks">Speech Recognition with Neural Networks</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/mathematics/matrix-multiplication">Matrix Multiplication</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/machine-learning/recurrent-neural-networks">Recurrent Neural Networks</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/machine-learning/gauss-newton-matrix">Gauss Newton Matrix</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/machine-learning/convolutional-neural-networks">Convolutional Neural Networks</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/machine-learning/fully-connected-neural-networks">Fully Connected Neural Network Algorithms</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/machine-learning/hessian-free-optimization">Hessian Free Optimization</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/machine-learning/conjugate-gradient">Conjugate Gradient</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/machine-learning/gradient-descent">Gradient Descent Typeclasses in Haskell</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/linguistics/homophony-groups">Homophony Groups in Haskell</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/ipython/ipython-kernels">Creating Language Kernels for IPython</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/machine-learning/qpcr-blog-post">Detecting Genetic Copynumber with Gaussian Mixture Models</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/machine-learning/k-nearest-neighbors-simplest-machine-learning">K Nearest Neighbors: Simplest Machine Learning</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/mathematics/cool-linear-algebra-singular-value-decomposition">Cool Linear Algebra: Singular Value Decomposition</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/economics/accelerating-options-pricing-via-fourier-transforms">Accelerating Options Pricing via Fourier Transforms</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/economics/binomial-options-pricing-model">Pricing Stock Options via the Binomial Model</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/electrical-engineering/your-very-first-microprocessor">Your Very First Microprocessor</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/electrical-engineering/circuits-and-arithmetic">Circuits and Arithmetic</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/electrical-engineering/digital-design-tools-verilog-and-hdls">Digital Design Tools: Verilog and HDLs</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/physics/quadcopter-dynamics">Quadcopter Dynamics and Simulation</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/electrical-engineering/the-digital-state">The Digital State</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/electrical-engineering/computing-with-transistors">Computing with Transistors</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/machine-learning/machine-learning-neural-networks">Machine Learning: Neural Networks</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/machine-learning/machine-learning-the-basics">Machine Learning: the Basics</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/economics/iranian-political-embargoes-and-their-non-existent-impact-on-gasoline-prices">Iranian Political Embargoes, and their Non-Existent Impact on Gasoline Prices</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/physics/computational-fluid-dynamics">Computational Fluid Dynamics</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/physics/fluid-dynamics-the-navier-stokes-equations">Fluid Dynamics: The Navier-Stokes Equations</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/image-processing/image-morphing">Image Morphing</a>
        </li>
      
    </ul>

  </section>

  <section>
      <p>The content on this blog is licensed under the <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA license</a>.</p>
  </section>
</aside>


    </div>
  </div>


<canvas id="xLabsCanvas" width="958" height="919" style="background: 0px center; display: none; width: 958px; height: 919px;"></canvas><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-size-adjust: none; font-family: MathJax_Size1, sans-serif;"></div></div></body></html>